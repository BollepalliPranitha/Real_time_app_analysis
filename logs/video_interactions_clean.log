2025-05-06 23:30:24,855 - INFO - Initializing Spark session
2025-05-06 23:30:29,823 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics/raw/video_interactions: Expected authority at index 6: s3a://
2025-05-06 23:30:30,187 - INFO - AWS SDK check for s3a://datastreaming-analytics/raw/video_interactions: file count: 2, files: [('raw/video_interactions/_SUCCESS', 0), ('raw/video_interactions/part-00000-e5fc34de-7979-4a35-a5a2-130e8150717d-c000.snappy.parquet', 151724)]
2025-05-06 23:30:30,195 - INFO - Reading raw data from s3a://datastreaming-analytics/raw/video_interactions
2025-05-06 23:30:38,761 - INFO - Raw schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('Owns Property', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('Number of Sessions', LongType(), True), StructField('Video ID', LongType(), True), StructField('Video Category', StringType(), True), StructField('Video Length', LongType(), True), StructField('Engagement', LongType(), True), StructField('Importance Score', LongType(), True), StructField('Time Spent On Video', LongType(), True), StructField('Number of Videos Watched', LongType(), True), StructField('Scroll Rate', LongType(), True), StructField('Frequency', StringType(), True), StructField('Productivity Loss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('Watch Reason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('Watch Time', StringType(), True), StructField('Self Control', LongType(), True), StructField('Addiction Level', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:30:40,413 - INFO - Schema applied for video_interactions: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('OwnsProperty', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), True), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), True), StructField('VideoLength', LongType(), True), StructField('Engagement', LongType(), True), StructField('ImportanceScore', LongType(), True), StructField('TimeSpentOnVideo', LongType(), True), StructField('NumberOfVideosWatched', LongType(), True), StructField('ScrollRate', LongType(), True), StructField('Frequency', StringType(), True), StructField('ProductivityLoss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('WatchReason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('WatchTime', StringType(), True), StructField('SelfControl', LongType(), True), StructField('AddictionLevel', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:30:42,554 - INFO - Raw row count: 2989
2025-05-06 23:30:44,715 - INFO - Null counts for video_interactions_before_null_drop: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 0, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 0, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 0, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 0, 'CurrentActivity': 0, 'ConnectionType': 0, 'IngestionTimestamp': 0}
2025-05-06 23:30:46,943 - INFO - Row count after dropping nulls in critical columns: 2989
2025-05-06 23:31:18,127 - INFO - Rejected row (Validation): UserID=2002, VideoID=2, Reason=Invalid SelfControl, Row=Row(UserID=2002, Age=41, Gender='Male', Location='Korea', Income=62133, Debt=True, OwnsProperty=True, Profession='Chief Marketing Officer', Demographics='Age: 41, Gender: Male, Income: 62133', Platform='YouTube', TotalTimeSpent=227, NumberOfSessions=17, VideoID=2, VideoCategory='Life Hacks', VideoLength=22, Engagement=4358, ImportanceScore=3, TimeSpentOnVideo=16, NumberOfVideosWatched=23, ScrollRate=71, Frequency='Evening', ProductivityLoss=5, Satisfaction=1, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='17:37:38', SelfControl=12, AddictionLevel=0, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Invalid SelfControl')
2025-05-06 23:31:18,128 - INFO - Rejected row (Validation): UserID=2003, VideoID=3, Reason=Negative ProductivityLoss, Row=Row(UserID=2003, Age=52, Gender='Female', Location='Zimbabwe', Income=49635, Debt=False, OwnsProperty=False, Profession='Outdoor activities/education manager', Demographics='Age: 52, Gender: Female, Income: 49635', Platform='TikTok', TotalTimeSpent=181, NumberOfSessions=10, VideoID=3, VideoCategory='ASMR', VideoLength=26, Engagement=2442, ImportanceScore=7, TimeSpentOnVideo=13, NumberOfVideosWatched=39, ScrollRate=32, Frequency='Evening', ProductivityLoss=-1, Satisfaction=6, WatchReason='Habit', DeviceType='Computer', OS='iOS', WatchTime='08:39:29', SelfControl=5, AddictionLevel=1, CurrentActivity='At school', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative ProductivityLoss')
2025-05-06 23:31:18,129 - INFO - Rejected row (Validation): UserID=2015, VideoID=15, Reason=Negative NumberOfSessions, Row=Row(UserID=2015, Age=27, Gender='Female', Location='Morocco', Income=63026, Debt=False, OwnsProperty=True, Profession='Museum education officer', Demographics='Age: 27, Gender: Female, Income: 63026', Platform='YouTube', TotalTimeSpent=80, NumberOfSessions=-1, VideoID=15, VideoCategory='Trends', VideoLength=9, Engagement=257, ImportanceScore=0, TimeSpentOnVideo=6, NumberOfVideosWatched=25, ScrollRate=62, Frequency='Afternoon', ProductivityLoss=3, Satisfaction=4, WatchReason='Habit', DeviceType='Tablet', OS='MacOS', WatchTime='22:29:16', SelfControl=8, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative NumberOfSessions')
2025-05-06 23:31:18,129 - INFO - Rejected row (Validation): UserID=2018, VideoID=18, Reason=Invalid SelfControl, Row=Row(UserID=2018, Age=26, Gender='Male', Location='Benin', Income=45541, Debt=True, OwnsProperty=True, Profession='Horticultural consultant', Demographics='Age: 26, Gender: Male, Income: 45541', Platform='Instagram', TotalTimeSpent=46, NumberOfSessions=4, VideoID=18, VideoCategory='Trends', VideoLength=12, Engagement=6814, ImportanceScore=8, TimeSpentOnVideo=15, NumberOfVideosWatched=31, ScrollRate=99, Frequency='Evening', ProductivityLoss=3, Satisfaction=8, WatchReason='Habit', DeviceType='Tablet', OS='iOS', WatchTime='17:24:13', SelfControl=12, AddictionLevel=1, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Invalid SelfControl')
2025-05-06 23:31:18,130 - INFO - Rejected row (Validation): UserID=2021, VideoID=21, Reason=Negative VideoLength, Row=Row(UserID=2021, Age=18, Gender='Other', Location='Egypt', Income=20138, Debt=False, OwnsProperty=False, Profession='Site engineer', Demographics='Age: 18, Gender: Other, Income: 20138', Platform='YouTube', TotalTimeSpent=135, NumberOfSessions=14, VideoID=21, VideoCategory='Jokes/Memes', VideoLength=-3, Engagement=1714, ImportanceScore=8, TimeSpentOnVideo=7, NumberOfVideosWatched=16, ScrollRate=58, Frequency='Evening', ProductivityLoss=4, Satisfaction=3, WatchReason='Entertainment', DeviceType='Smartphone', OS='MacOS', WatchTime='01:21:48', SelfControl=7, AddictionLevel=5, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:31:18,131 - INFO - Rejected row (Validation): UserID=2105, VideoID=105, Reason=Negative VideoLength, Row=Row(UserID=2105, Age=56, Gender='Male', Location='North Macedonia', Income=87476, Debt=True, OwnsProperty=True, Profession='Retail buyer', Demographics='Age: 56, Gender: Male, Income: 87476', Platform='Facebook', TotalTimeSpent=75, NumberOfSessions=10, VideoID=105, VideoCategory='Trends', VideoLength=-10, Engagement=6827, ImportanceScore=5, TimeSpentOnVideo=15, NumberOfVideosWatched=44, ScrollRate=81, Frequency='Evening', ProductivityLoss=1, Satisfaction=6, WatchReason='Habit', DeviceType='Smartphone', OS='Android', WatchTime='05:59:58', SelfControl=7, AddictionLevel=2, CurrentActivity='Commuting', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:31:18,131 - INFO - Rejected row (Validation): UserID=2119, VideoID=119, Reason=Negative VideoLength, Row=Row(UserID=2119, Age=39, Gender='Female', Location='Bosnia and Herzegovina', Income=55799, Debt=False, OwnsProperty=True, Profession='Environmental health practitioner', Demographics='Age: 39, Gender: Female, Income: 55799', Platform='Instagram', TotalTimeSpent=153, NumberOfSessions=8, VideoID=119, VideoCategory='Vlogs', VideoLength=-1, Engagement=4304, ImportanceScore=3, TimeSpentOnVideo=2, NumberOfVideosWatched=31, ScrollRate=46, Frequency='Evening', ProductivityLoss=7, Satisfaction=3, WatchReason='Procrastination', DeviceType='Smartphone', OS='iOS', WatchTime='12:34:22', SelfControl=10, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:31:18,132 - INFO - Rejected row (Validation): UserID=2134, VideoID=134, Reason=Negative VideoLength, Row=Row(UserID=2134, Age=46, Gender='Male', Location='Poland', Income=45872, Debt=False, OwnsProperty=True, Profession='Armed forces operational officer', Demographics='Age: 46, Gender: Male, Income: 45872', Platform='TikTok', TotalTimeSpent=108, NumberOfSessions=14, VideoID=134, VideoCategory='Pranks', VideoLength=-1, Engagement=3293, ImportanceScore=2, TimeSpentOnVideo=20, NumberOfVideosWatched=42, ScrollRate=32, Frequency='Morning', ProductivityLoss=3, Satisfaction=1, WatchReason='Boredom', DeviceType='Tablet', OS='iOS', WatchTime='20:50:57', SelfControl=5, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:31:18,132 - INFO - Rejected row (Validation): UserID=2158, VideoID=158, Reason=Negative NumberOfSessions, Row=Row(UserID=2158, Age=40, Gender='Female', Location='Mexico', Income=38041, Debt=False, OwnsProperty=True, Profession='Operational researcher', Demographics='Age: 40, Gender: Female, Income: 38041', Platform='YouTube', TotalTimeSpent=112, NumberOfSessions=-1, VideoID=158, VideoCategory='Gaming', VideoLength=15, Engagement=7885, ImportanceScore=2, TimeSpentOnVideo=15, NumberOfVideosWatched=23, ScrollRate=28, Frequency='Afternoon', ProductivityLoss=8, Satisfaction=2, WatchReason='Boredom', DeviceType='Smartphone', OS='Android', WatchTime='21:47:20', SelfControl=8, AddictionLevel=0, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative NumberOfSessions')
2025-05-06 23:31:18,133 - INFO - Rejected row (Validation): UserID=2168, VideoID=168, Reason=Negative NumberOfSessions, Row=Row(UserID=2168, Age=57, Gender='Male', Location='Niger', Income=63157, Debt=False, OwnsProperty=True, Profession='Legal secretary', Demographics='Age: 57, Gender: Male, Income: 63157', Platform='TikTok', TotalTimeSpent=201, NumberOfSessions=-3, VideoID=168, VideoCategory='Life Hacks', VideoLength=12, Engagement=6107, ImportanceScore=6, TimeSpentOnVideo=20, NumberOfVideosWatched=22, ScrollRate=24, Frequency='Night', ProductivityLoss=5, Satisfaction=6, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='23:05:37', SelfControl=7, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative NumberOfSessions')
2025-05-06 23:31:19,097 - INFO - Row count after validation filters: 2833
2025-05-06 23:31:24,131 - INFO - Updated row: UserID=2, VideoID=2131, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,132 - INFO - Updated row: UserID=6, VideoID=2917, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,132 - INFO - Updated row: UserID=9, VideoID=6266, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,133 - INFO - Updated row: UserID=22, VideoID=7873, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,133 - INFO - Updated row: UserID=54, VideoID=9473, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,134 - INFO - Updated row: UserID=63, VideoID=8481, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,134 - INFO - Updated row: UserID=64, VideoID=1410, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,135 - INFO - Updated row: UserID=70, VideoID=2991, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,136 - INFO - Updated row: UserID=73, VideoID=4366, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:24,136 - INFO - Updated row: UserID=75, VideoID=6767, Field=DeviceType, OldValue=Computer, NewValue=Unknown, Reason='Standardized DeviceType'
2025-05-06 23:31:27,482 - INFO - Updated row: UserID=1, VideoID=4229, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,482 - INFO - Updated row: UserID=3, VideoID=4367, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,483 - INFO - Updated row: UserID=4, VideoID=1507, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,483 - INFO - Updated row: UserID=5, VideoID=2159, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,484 - INFO - Updated row: UserID=8, VideoID=9859, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,484 - INFO - Updated row: UserID=9, VideoID=6266, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,485 - INFO - Updated row: UserID=10, VideoID=4137, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,486 - INFO - Updated row: UserID=11, VideoID=2690, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,486 - INFO - Updated row: UserID=13, VideoID=2811, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:27,487 - INFO - Updated row: UserID=16, VideoID=5939, Field=ConnectionType, OldValue=Mobile Data, NewValue=Unknown, Reason='Standardized ConnectionType'
2025-05-06 23:31:30,025 - INFO - Row count after deduplication: 2833
2025-05-06 23:31:34,415 - INFO - Updated row: UserID=1021, VideoID=21, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,415 - INFO - Updated row: UserID=1056, VideoID=56, Field=Location, OldValue=Cocos (Keeling) Islands, NewValue=Cocos (keeling) Islands, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,416 - INFO - Updated row: UserID=1069, VideoID=69, Field=Location, OldValue=Antigua and Barbuda, NewValue=Antigua And Barbuda, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,416 - INFO - Updated row: UserID=1093, VideoID=93, Field=Location, OldValue=Falkland Islands (Malvinas), NewValue=Falkland Islands (malvinas), Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,416 - INFO - Updated row: UserID=1103, VideoID=103, Field=Location, OldValue=Trinidad and Tobago, NewValue=Trinidad And Tobago, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,417 - INFO - Updated row: UserID=1114, VideoID=114, Field=Location, OldValue=Isle of Man, NewValue=Isle Of Man, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,417 - INFO - Updated row: UserID=1119, VideoID=119, Field=Location, OldValue=Antarctica (the territory South of 60 deg S), NewValue=Antarctica (the Territory South Of 60 Deg S), Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,417 - INFO - Updated row: UserID=1125, VideoID=125, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,418 - INFO - Updated row: UserID=1133, VideoID=133, Field=Location, OldValue=Sao Tome and Principe, NewValue=Sao Tome And Principe, Reason='Trimmed and formatted Location'
2025-05-06 23:31:34,418 - INFO - Updated row: UserID=1145, VideoID=145, Field=Location, OldValue=Wallis and Futuna, NewValue=Wallis And Futuna, Reason='Trimmed and formatted Location'
2025-05-06 23:31:36,273 - INFO - Updated row: UserID=4, VideoID=1507, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,274 - INFO - Updated row: UserID=6, VideoID=2917, Field=Profession, OldValue=driver, NewValue=Driver, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,275 - INFO - Updated row: UserID=9, VideoID=6266, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,276 - INFO - Updated row: UserID=12, VideoID=7191, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,276 - INFO - Updated row: UserID=13, VideoID=2811, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,277 - INFO - Updated row: UserID=14, VideoID=6153, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,278 - INFO - Updated row: UserID=17, VideoID=8000, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,279 - INFO - Updated row: UserID=19, VideoID=5329, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,280 - INFO - Updated row: UserID=20, VideoID=3622, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:36,280 - INFO - Updated row: UserID=21, VideoID=3684, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:31:37,756 - INFO - Updated row: UserID=4, VideoID=1507, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,757 - INFO - Updated row: UserID=5, VideoID=2159, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,758 - INFO - Updated row: UserID=7, VideoID=3230, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,759 - INFO - Updated row: UserID=10, VideoID=4137, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,759 - INFO - Updated row: UserID=12, VideoID=7191, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,760 - INFO - Updated row: UserID=15, VideoID=13, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,761 - INFO - Updated row: UserID=16, VideoID=5939, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,761 - INFO - Updated row: UserID=21, VideoID=3684, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,762 - INFO - Updated row: UserID=25, VideoID=5800, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:37,763 - INFO - Updated row: UserID=26, VideoID=8813, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:31:39,484 - INFO - Updated row: UserID=6, VideoID=2917, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,485 - INFO - Updated row: UserID=10, VideoID=4137, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,485 - INFO - Updated row: UserID=17, VideoID=8000, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,486 - INFO - Updated row: UserID=18, VideoID=7220, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,487 - INFO - Updated row: UserID=25, VideoID=5800, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,488 - INFO - Updated row: UserID=26, VideoID=8813, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,489 - INFO - Updated row: UserID=32, VideoID=3689, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,489 - INFO - Updated row: UserID=36, VideoID=9581, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,490 - INFO - Updated row: UserID=38, VideoID=7820, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:39,491 - INFO - Updated row: UserID=39, VideoID=8594, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:31:46,825 - INFO - Updated row: UserID=5, VideoID=2159, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,825 - INFO - Updated row: UserID=10, VideoID=4137, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,826 - INFO - Updated row: UserID=15, VideoID=13, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,827 - INFO - Updated row: UserID=16, VideoID=5939, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,827 - INFO - Updated row: UserID=17, VideoID=8000, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,828 - INFO - Updated row: UserID=19, VideoID=5329, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,829 - INFO - Updated row: UserID=20, VideoID=3622, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,829 - INFO - Updated row: UserID=21, VideoID=3684, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,830 - INFO - Updated row: UserID=24, VideoID=653, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:46,831 - INFO - Updated row: UserID=28, VideoID=1646, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:31:50,377 - INFO - Updated row: UserID=2, VideoID=2131, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,378 - INFO - Updated row: UserID=3, VideoID=4367, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,379 - INFO - Updated row: UserID=5, VideoID=2159, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,380 - INFO - Updated row: UserID=6, VideoID=2917, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,381 - INFO - Updated row: UserID=7, VideoID=3230, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,381 - INFO - Updated row: UserID=8, VideoID=9859, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,382 - INFO - Updated row: UserID=9, VideoID=6266, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,383 - INFO - Updated row: UserID=10, VideoID=4137, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,383 - INFO - Updated row: UserID=11, VideoID=2690, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:50,384 - INFO - Updated row: UserID=12, VideoID=7191, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:31:54,558 - INFO - Null counts for video_interactions_cleaned: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 0, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 0, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 0, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 0, 'CurrentActivity': 0, 'ConnectionType': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-06 23:32:03,965 - INFO - Successfully wrote 2833 rows to s3a://datastreaming-analytics/staging/video_interactions
2025-05-06 23:32:03,966 - INFO - Written schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('Location', StringType(), False), StructField('Income', LongType(), False), StructField('Debt', BooleanType(), False), StructField('OwnsProperty', BooleanType(), False), StructField('Profession', StringType(), False), StructField('Demographics', StringType(), False), StructField('Platform', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), False), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), False), StructField('VideoLength', LongType(), False), StructField('Engagement', LongType(), False), StructField('ImportanceScore', LongType(), False), StructField('TimeSpentOnVideo', LongType(), False), StructField('NumberOfVideosWatched', LongType(), False), StructField('ScrollRate', LongType(), False), StructField('Frequency', StringType(), False), StructField('ProductivityLoss', LongType(), False), StructField('Satisfaction', LongType(), False), StructField('WatchReason', StringType(), False), StructField('DeviceType', StringType(), False), StructField('OS', StringType(), False), StructField('WatchTime', StringType(), False), StructField('SelfControl', LongType(), False), StructField('AddictionLevel', LongType(), False), StructField('CurrentActivity', StringType(), False), StructField('ConnectionType', StringType(), False), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-06 23:32:05,131 - INFO - Closing down clientserver connection
2025-05-06 23:38:59,176 - INFO - Initializing Spark session
2025-05-06 23:39:02,385 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics/raw/video_interactions: Expected authority at index 6: s3a://
2025-05-06 23:39:02,899 - INFO - AWS SDK check for s3a://datastreaming-analytics/raw/video_interactions: file count: 2, files: [('raw/video_interactions/_SUCCESS', 0), ('raw/video_interactions/part-00000-e5fc34de-7979-4a35-a5a2-130e8150717d-c000.snappy.parquet', 151724)]
2025-05-06 23:39:02,900 - INFO - Reading raw data from s3a://datastreaming-analytics/raw/video_interactions
2025-05-06 23:39:11,531 - INFO - Raw schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('Owns Property', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('Number of Sessions', LongType(), True), StructField('Video ID', LongType(), True), StructField('Video Category', StringType(), True), StructField('Video Length', LongType(), True), StructField('Engagement', LongType(), True), StructField('Importance Score', LongType(), True), StructField('Time Spent On Video', LongType(), True), StructField('Number of Videos Watched', LongType(), True), StructField('Scroll Rate', LongType(), True), StructField('Frequency', StringType(), True), StructField('Productivity Loss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('Watch Reason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('Watch Time', StringType(), True), StructField('Self Control', LongType(), True), StructField('Addiction Level', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:39:13,560 - INFO - Schema applied for video_interactions: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('OwnsProperty', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), True), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), True), StructField('VideoLength', LongType(), True), StructField('Engagement', LongType(), True), StructField('ImportanceScore', LongType(), True), StructField('TimeSpentOnVideo', LongType(), True), StructField('NumberOfVideosWatched', LongType(), True), StructField('ScrollRate', LongType(), True), StructField('Frequency', StringType(), True), StructField('ProductivityLoss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('WatchReason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('WatchTime', StringType(), True), StructField('SelfControl', LongType(), True), StructField('AddictionLevel', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:39:17,685 - INFO - Raw row count: 2989
2025-05-06 23:39:19,896 - INFO - Null counts for video_interactions_before_null_drop: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 0, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 0, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 0, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 0, 'CurrentActivity': 0, 'ConnectionType': 0, 'IngestionTimestamp': 0}
2025-05-06 23:39:22,187 - INFO - Row count after dropping nulls in critical columns: 2989
2025-05-06 23:39:54,031 - INFO - Rejected row (Validation): UserID=2002, VideoID=2, Reason=Invalid SelfControl, Row=Row(UserID=2002, Age=41, Gender='Male', Location='Korea', Income=62133, Debt=True, OwnsProperty=True, Profession='Chief Marketing Officer', Demographics='Age: 41, Gender: Male, Income: 62133', Platform='YouTube', TotalTimeSpent=227, NumberOfSessions=17, VideoID=2, VideoCategory='Life Hacks', VideoLength=22, Engagement=4358, ImportanceScore=3, TimeSpentOnVideo=16, NumberOfVideosWatched=23, ScrollRate=71, Frequency='Evening', ProductivityLoss=5, Satisfaction=1, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='17:37:38', SelfControl=12, AddictionLevel=0, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Invalid SelfControl')
2025-05-06 23:39:54,032 - INFO - Rejected row (Validation): UserID=2003, VideoID=3, Reason=Negative ProductivityLoss, Row=Row(UserID=2003, Age=52, Gender='Female', Location='Zimbabwe', Income=49635, Debt=False, OwnsProperty=False, Profession='Outdoor activities/education manager', Demographics='Age: 52, Gender: Female, Income: 49635', Platform='TikTok', TotalTimeSpent=181, NumberOfSessions=10, VideoID=3, VideoCategory='ASMR', VideoLength=26, Engagement=2442, ImportanceScore=7, TimeSpentOnVideo=13, NumberOfVideosWatched=39, ScrollRate=32, Frequency='Evening', ProductivityLoss=-1, Satisfaction=6, WatchReason='Habit', DeviceType='Computer', OS='iOS', WatchTime='08:39:29', SelfControl=5, AddictionLevel=1, CurrentActivity='At school', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative ProductivityLoss')
2025-05-06 23:39:54,033 - INFO - Rejected row (Validation): UserID=2015, VideoID=15, Reason=Negative NumberOfSessions, Row=Row(UserID=2015, Age=27, Gender='Female', Location='Morocco', Income=63026, Debt=False, OwnsProperty=True, Profession='Museum education officer', Demographics='Age: 27, Gender: Female, Income: 63026', Platform='YouTube', TotalTimeSpent=80, NumberOfSessions=-1, VideoID=15, VideoCategory='Trends', VideoLength=9, Engagement=257, ImportanceScore=0, TimeSpentOnVideo=6, NumberOfVideosWatched=25, ScrollRate=62, Frequency='Afternoon', ProductivityLoss=3, Satisfaction=4, WatchReason='Habit', DeviceType='Tablet', OS='MacOS', WatchTime='22:29:16', SelfControl=8, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative NumberOfSessions')
2025-05-06 23:39:54,034 - INFO - Rejected row (Validation): UserID=2018, VideoID=18, Reason=Invalid SelfControl, Row=Row(UserID=2018, Age=26, Gender='Male', Location='Benin', Income=45541, Debt=True, OwnsProperty=True, Profession='Horticultural consultant', Demographics='Age: 26, Gender: Male, Income: 45541', Platform='Instagram', TotalTimeSpent=46, NumberOfSessions=4, VideoID=18, VideoCategory='Trends', VideoLength=12, Engagement=6814, ImportanceScore=8, TimeSpentOnVideo=15, NumberOfVideosWatched=31, ScrollRate=99, Frequency='Evening', ProductivityLoss=3, Satisfaction=8, WatchReason='Habit', DeviceType='Tablet', OS='iOS', WatchTime='17:24:13', SelfControl=12, AddictionLevel=1, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Invalid SelfControl')
2025-05-06 23:39:54,035 - INFO - Rejected row (Validation): UserID=2021, VideoID=21, Reason=Negative VideoLength, Row=Row(UserID=2021, Age=18, Gender='Other', Location='Egypt', Income=20138, Debt=False, OwnsProperty=False, Profession='Site engineer', Demographics='Age: 18, Gender: Other, Income: 20138', Platform='YouTube', TotalTimeSpent=135, NumberOfSessions=14, VideoID=21, VideoCategory='Jokes/Memes', VideoLength=-3, Engagement=1714, ImportanceScore=8, TimeSpentOnVideo=7, NumberOfVideosWatched=16, ScrollRate=58, Frequency='Evening', ProductivityLoss=4, Satisfaction=3, WatchReason='Entertainment', DeviceType='Smartphone', OS='MacOS', WatchTime='01:21:48', SelfControl=7, AddictionLevel=5, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:39:54,036 - INFO - Rejected row (Validation): UserID=2105, VideoID=105, Reason=Negative VideoLength, Row=Row(UserID=2105, Age=56, Gender='Male', Location='North Macedonia', Income=87476, Debt=True, OwnsProperty=True, Profession='Retail buyer', Demographics='Age: 56, Gender: Male, Income: 87476', Platform='Facebook', TotalTimeSpent=75, NumberOfSessions=10, VideoID=105, VideoCategory='Trends', VideoLength=-10, Engagement=6827, ImportanceScore=5, TimeSpentOnVideo=15, NumberOfVideosWatched=44, ScrollRate=81, Frequency='Evening', ProductivityLoss=1, Satisfaction=6, WatchReason='Habit', DeviceType='Smartphone', OS='Android', WatchTime='05:59:58', SelfControl=7, AddictionLevel=2, CurrentActivity='Commuting', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:39:54,036 - INFO - Rejected row (Validation): UserID=2119, VideoID=119, Reason=Negative VideoLength, Row=Row(UserID=2119, Age=39, Gender='Female', Location='Bosnia and Herzegovina', Income=55799, Debt=False, OwnsProperty=True, Profession='Environmental health practitioner', Demographics='Age: 39, Gender: Female, Income: 55799', Platform='Instagram', TotalTimeSpent=153, NumberOfSessions=8, VideoID=119, VideoCategory='Vlogs', VideoLength=-1, Engagement=4304, ImportanceScore=3, TimeSpentOnVideo=2, NumberOfVideosWatched=31, ScrollRate=46, Frequency='Evening', ProductivityLoss=7, Satisfaction=3, WatchReason='Procrastination', DeviceType='Smartphone', OS='iOS', WatchTime='12:34:22', SelfControl=10, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:39:54,037 - INFO - Rejected row (Validation): UserID=2134, VideoID=134, Reason=Negative VideoLength, Row=Row(UserID=2134, Age=46, Gender='Male', Location='Poland', Income=45872, Debt=False, OwnsProperty=True, Profession='Armed forces operational officer', Demographics='Age: 46, Gender: Male, Income: 45872', Platform='TikTok', TotalTimeSpent=108, NumberOfSessions=14, VideoID=134, VideoCategory='Pranks', VideoLength=-1, Engagement=3293, ImportanceScore=2, TimeSpentOnVideo=20, NumberOfVideosWatched=42, ScrollRate=32, Frequency='Morning', ProductivityLoss=3, Satisfaction=1, WatchReason='Boredom', DeviceType='Tablet', OS='iOS', WatchTime='20:50:57', SelfControl=5, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative VideoLength')
2025-05-06 23:39:54,038 - INFO - Rejected row (Validation): UserID=2158, VideoID=158, Reason=Negative NumberOfSessions, Row=Row(UserID=2158, Age=40, Gender='Female', Location='Mexico', Income=38041, Debt=False, OwnsProperty=True, Profession='Operational researcher', Demographics='Age: 40, Gender: Female, Income: 38041', Platform='YouTube', TotalTimeSpent=112, NumberOfSessions=-1, VideoID=158, VideoCategory='Gaming', VideoLength=15, Engagement=7885, ImportanceScore=2, TimeSpentOnVideo=15, NumberOfVideosWatched=23, ScrollRate=28, Frequency='Afternoon', ProductivityLoss=8, Satisfaction=2, WatchReason='Boredom', DeviceType='Smartphone', OS='Android', WatchTime='21:47:20', SelfControl=8, AddictionLevel=0, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative NumberOfSessions')
2025-05-06 23:39:54,039 - INFO - Rejected row (Validation): UserID=2168, VideoID=168, Reason=Negative NumberOfSessions, Row=Row(UserID=2168, Age=57, Gender='Male', Location='Niger', Income=63157, Debt=False, OwnsProperty=True, Profession='Legal secretary', Demographics='Age: 57, Gender: Male, Income: 63157', Platform='TikTok', TotalTimeSpent=201, NumberOfSessions=-3, VideoID=168, VideoCategory='Life Hacks', VideoLength=12, Engagement=6107, ImportanceScore=6, TimeSpentOnVideo=20, NumberOfVideosWatched=22, ScrollRate=24, Frequency='Night', ProductivityLoss=5, Satisfaction=6, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='23:05:37', SelfControl=7, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 51, 12, 132954), Reason='Negative NumberOfSessions')
2025-05-06 23:39:55,060 - INFO - Row count after validation filters: 2833
2025-05-06 23:40:00,041 - INFO - Updated row: UserID=2, VideoID=2131, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,041 - INFO - Updated row: UserID=6, VideoID=2917, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,042 - INFO - Updated row: UserID=9, VideoID=6266, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,043 - INFO - Updated row: UserID=22, VideoID=7873, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,043 - INFO - Updated row: UserID=54, VideoID=9473, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,044 - INFO - Updated row: UserID=63, VideoID=8481, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,044 - INFO - Updated row: UserID=64, VideoID=1410, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,045 - INFO - Updated row: UserID=70, VideoID=2991, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,045 - INFO - Updated row: UserID=73, VideoID=4366, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:00,046 - INFO - Updated row: UserID=75, VideoID=6767, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:40:01,067 - INFO - Updated row: UserID=1, VideoID=4229, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,068 - INFO - Updated row: UserID=3, VideoID=4367, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,068 - INFO - Updated row: UserID=4, VideoID=1507, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,069 - INFO - Updated row: UserID=5, VideoID=2159, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,069 - INFO - Updated row: UserID=8, VideoID=9859, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,070 - INFO - Updated row: UserID=9, VideoID=6266, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,070 - INFO - Updated row: UserID=10, VideoID=4137, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,071 - INFO - Updated row: UserID=11, VideoID=2690, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,072 - INFO - Updated row: UserID=13, VideoID=2811, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:01,072 - INFO - Updated row: UserID=16, VideoID=5939, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:40:03,632 - INFO - Row count after deduplication: 2833
2025-05-06 23:40:07,570 - INFO - Updated row: UserID=1021, VideoID=21, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,571 - INFO - Updated row: UserID=1056, VideoID=56, Field=Location, OldValue=Cocos (Keeling) Islands, NewValue=Cocos (keeling) Islands, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,572 - INFO - Updated row: UserID=1069, VideoID=69, Field=Location, OldValue=Antigua and Barbuda, NewValue=Antigua And Barbuda, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,572 - INFO - Updated row: UserID=1093, VideoID=93, Field=Location, OldValue=Falkland Islands (Malvinas), NewValue=Falkland Islands (malvinas), Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,573 - INFO - Updated row: UserID=1103, VideoID=103, Field=Location, OldValue=Trinidad and Tobago, NewValue=Trinidad And Tobago, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,573 - INFO - Updated row: UserID=1114, VideoID=114, Field=Location, OldValue=Isle of Man, NewValue=Isle Of Man, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,574 - INFO - Updated row: UserID=1119, VideoID=119, Field=Location, OldValue=Antarctica (the territory South of 60 deg S), NewValue=Antarctica (the Territory South Of 60 Deg S), Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,575 - INFO - Updated row: UserID=1125, VideoID=125, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,575 - INFO - Updated row: UserID=1133, VideoID=133, Field=Location, OldValue=Sao Tome and Principe, NewValue=Sao Tome And Principe, Reason='Trimmed and formatted Location'
2025-05-06 23:40:07,576 - INFO - Updated row: UserID=1145, VideoID=145, Field=Location, OldValue=Wallis and Futuna, NewValue=Wallis And Futuna, Reason='Trimmed and formatted Location'
2025-05-06 23:40:09,351 - INFO - Updated row: UserID=4, VideoID=1507, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,352 - INFO - Updated row: UserID=6, VideoID=2917, Field=Profession, OldValue=driver, NewValue=Driver, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,353 - INFO - Updated row: UserID=9, VideoID=6266, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,353 - INFO - Updated row: UserID=12, VideoID=7191, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,354 - INFO - Updated row: UserID=13, VideoID=2811, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,354 - INFO - Updated row: UserID=14, VideoID=6153, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,355 - INFO - Updated row: UserID=17, VideoID=8000, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,357 - INFO - Updated row: UserID=19, VideoID=5329, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,357 - INFO - Updated row: UserID=20, VideoID=3622, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:09,358 - INFO - Updated row: UserID=21, VideoID=3684, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:40:13,119 - INFO - Updated row: UserID=4, VideoID=1507, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,119 - INFO - Updated row: UserID=5, VideoID=2159, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,120 - INFO - Updated row: UserID=7, VideoID=3230, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,120 - INFO - Updated row: UserID=10, VideoID=4137, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,121 - INFO - Updated row: UserID=12, VideoID=7191, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,121 - INFO - Updated row: UserID=15, VideoID=13, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,122 - INFO - Updated row: UserID=16, VideoID=5939, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,122 - INFO - Updated row: UserID=21, VideoID=3684, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,123 - INFO - Updated row: UserID=25, VideoID=5800, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:13,123 - INFO - Updated row: UserID=26, VideoID=8813, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:40:15,141 - INFO - Updated row: UserID=6, VideoID=2917, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,142 - INFO - Updated row: UserID=10, VideoID=4137, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,142 - INFO - Updated row: UserID=17, VideoID=8000, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,143 - INFO - Updated row: UserID=18, VideoID=7220, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,144 - INFO - Updated row: UserID=25, VideoID=5800, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,145 - INFO - Updated row: UserID=26, VideoID=8813, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,145 - INFO - Updated row: UserID=32, VideoID=3689, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,146 - INFO - Updated row: UserID=36, VideoID=9581, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,147 - INFO - Updated row: UserID=38, VideoID=7820, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:15,148 - INFO - Updated row: UserID=39, VideoID=8594, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:40:22,286 - INFO - Updated row: UserID=5, VideoID=2159, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,287 - INFO - Updated row: UserID=10, VideoID=4137, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,288 - INFO - Updated row: UserID=15, VideoID=13, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,289 - INFO - Updated row: UserID=16, VideoID=5939, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,290 - INFO - Updated row: UserID=17, VideoID=8000, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,290 - INFO - Updated row: UserID=19, VideoID=5329, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,291 - INFO - Updated row: UserID=20, VideoID=3622, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,292 - INFO - Updated row: UserID=21, VideoID=3684, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,318 - INFO - Updated row: UserID=24, VideoID=653, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:22,319 - INFO - Updated row: UserID=28, VideoID=1646, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:40:25,865 - INFO - Updated row: UserID=2, VideoID=2131, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,866 - INFO - Updated row: UserID=3, VideoID=4367, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,867 - INFO - Updated row: UserID=5, VideoID=2159, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,867 - INFO - Updated row: UserID=6, VideoID=2917, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,868 - INFO - Updated row: UserID=7, VideoID=3230, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,869 - INFO - Updated row: UserID=8, VideoID=9859, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,869 - INFO - Updated row: UserID=9, VideoID=6266, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,870 - INFO - Updated row: UserID=10, VideoID=4137, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,870 - INFO - Updated row: UserID=11, VideoID=2690, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:25,871 - INFO - Updated row: UserID=12, VideoID=7191, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:40:27,107 - INFO - Null counts for video_interactions_cleaned: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 0, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 0, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 0, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 0, 'CurrentActivity': 0, 'ConnectionType': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-06 23:40:36,016 - INFO - Successfully wrote 2833 rows to s3a://datastreaming-analytics/staging/video_interactions
2025-05-06 23:40:36,017 - INFO - Written schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('Location', StringType(), False), StructField('Income', LongType(), False), StructField('Debt', BooleanType(), False), StructField('OwnsProperty', BooleanType(), False), StructField('Profession', StringType(), False), StructField('Demographics', StringType(), False), StructField('Platform', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), False), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), False), StructField('VideoLength', LongType(), False), StructField('Engagement', LongType(), False), StructField('ImportanceScore', LongType(), False), StructField('TimeSpentOnVideo', LongType(), False), StructField('NumberOfVideosWatched', LongType(), False), StructField('ScrollRate', LongType(), False), StructField('Frequency', StringType(), False), StructField('ProductivityLoss', LongType(), False), StructField('Satisfaction', LongType(), False), StructField('WatchReason', StringType(), False), StructField('DeviceType', StringType(), False), StructField('OS', StringType(), False), StructField('WatchTime', StringType(), False), StructField('SelfControl', LongType(), False), StructField('AddictionLevel', LongType(), False), StructField('CurrentActivity', StringType(), False), StructField('ConnectionType', StringType(), False), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-06 23:40:37,152 - INFO - Closing down clientserver connection
2025-05-06 23:51:08,660 - INFO - Initializing Spark session
2025-05-06 23:51:13,729 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics-1/raw/video_interactions: Expected authority at index 6: s3a://
2025-05-06 23:51:14,215 - INFO - AWS SDK check for s3a://datastreaming-analytics-1/raw/video_interactions: file count: 2, files: [('raw/video_interactions/_SUCCESS', 0), ('raw/video_interactions/part-00000-ab9f1dcf-a846-449a-83bf-d26c28db682c-c000.snappy.parquet', 207851)]
2025-05-06 23:51:14,216 - INFO - Reading raw data from s3a://datastreaming-analytics-1/raw/video_interactions
2025-05-06 23:51:22,297 - INFO - Raw schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('Owns Property', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('Number of Sessions', LongType(), True), StructField('Video ID', LongType(), True), StructField('Video Category', StringType(), True), StructField('Video Length', LongType(), True), StructField('Engagement', LongType(), True), StructField('Importance Score', LongType(), True), StructField('Time Spent On Video', LongType(), True), StructField('Number of Videos Watched', LongType(), True), StructField('Scroll Rate', LongType(), True), StructField('Frequency', StringType(), True), StructField('Productivity Loss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('Watch Reason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('Watch Time', StringType(), True), StructField('Self Control', LongType(), True), StructField('Addiction Level', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:51:24,306 - INFO - Schema applied for video_interactions: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('OwnsProperty', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), True), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), True), StructField('VideoLength', LongType(), True), StructField('Engagement', LongType(), True), StructField('ImportanceScore', LongType(), True), StructField('TimeSpentOnVideo', LongType(), True), StructField('NumberOfVideosWatched', LongType(), True), StructField('ScrollRate', LongType(), True), StructField('Frequency', StringType(), True), StructField('ProductivityLoss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('WatchReason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('WatchTime', StringType(), True), StructField('SelfControl', LongType(), True), StructField('AddictionLevel', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:51:29,284 - INFO - Raw row count: 4000
2025-05-06 23:51:31,788 - INFO - Null counts for video_interactions_before_null_drop: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 1000, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 1000, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 1000, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 1000, 'CurrentActivity': 0, 'ConnectionType': 1000, 'IngestionTimestamp': 0}
2025-05-06 23:51:33,126 - WARNING - Found 1000 rows with nulls in critical columns for video_interactions_before_null_drop
2025-05-06 23:51:33,987 - INFO - Rejected row (Nulls): UserID=3001, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3001, Age=39, Gender='Other', Location='Yemen', Income=75534, Debt=True, OwnsProperty=False, Profession='Higher education careers adviser', Demographics='YouTube', Platform='176', TotalTimeSpent=14, NumberOfSessions=1, VideoID=None, VideoCategory='19', VideoLength=4527, Engagement=3, ImportanceScore=22, TimeSpentOnVideo=25, NumberOfVideosWatched=44, ScrollRate=None, Frequency='3', ProductivityLoss=4, Satisfaction=None, WatchReason='Computer', DeviceType='MacOS', OS='14:09:22', WatchTime='5', SelfControl=3, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,988 - INFO - Rejected row (Nulls): UserID=3002, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3002, Age=53, Gender='Male', Location='United States Minor Outlying Islands', Income=53101, Debt=False, OwnsProperty=False, Profession='Medical physicist', Demographics='Facebook', Platform='285', TotalTimeSpent=14, NumberOfSessions=2, VideoID=None, VideoCategory='9', VideoLength=5062, Engagement=12, ImportanceScore=13, TimeSpentOnVideo=46, NumberOfVideosWatched=31, ScrollRate=None, Frequency='2', ProductivityLoss=3, Satisfaction=None, WatchReason='Tablet', DeviceType='Windows', OS='08:42:04', WatchTime='8', SelfControl=2, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,989 - INFO - Rejected row (Nulls): UserID=3003, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3003, Age=52, Gender='Male', Location='Nicaragua', Income=82402, Debt=True, OwnsProperty=False, Profession='Therapist, occupational', Demographics='Facebook', Platform='168', TotalTimeSpent=9, NumberOfSessions=3, VideoID=None, VideoCategory='17', VideoLength=8805, Engagement=7, ImportanceScore=17, TimeSpentOnVideo=39, NumberOfVideosWatched=55, ScrollRate=None, Frequency='3', ProductivityLoss=7, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='11:17:09', WatchTime='7', SelfControl=3, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,989 - INFO - Rejected row (Nulls): UserID=3004, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3004, Age=18, Gender='Male', Location='Kenya', Income=23257, Debt=False, OwnsProperty=False, Profession='Quarry manager', Demographics='Facebook', Platform='124', TotalTimeSpent=16, NumberOfSessions=4, VideoID=None, VideoCategory='23', VideoLength=9121, Engagement=2, ImportanceScore=29, TimeSpentOnVideo=33, NumberOfVideosWatched=94, ScrollRate=None, Frequency='7', ProductivityLoss=2, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='20:00:00', WatchTime='5', SelfControl=2, AddictionLevel=None, CurrentActivity='Wi-Fi', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,990 - INFO - Rejected row (Nulls): UserID=3005, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3005, Age=27, Gender='Female', Location='Bosnia and Herzegovina', Income=41874, Debt=False, OwnsProperty=True, Profession='Adult nurse', Demographics='Instagram', Platform='222', TotalTimeSpent=13, NumberOfSessions=5, VideoID=None, VideoCategory='5', VideoLength=3546, Engagement=4, ImportanceScore=6, TimeSpentOnVideo=14, NumberOfVideosWatched=58, ScrollRate=None, Frequency='5', ProductivityLoss=2, Satisfaction=None, WatchReason='Tablet', DeviceType='iOS', OS='03:12:17', WatchTime='6', SelfControl=6, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,990 - INFO - Rejected row (Nulls): UserID=3006, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3006, Age=42, Gender='Male', Location='Trinidad and Tobago', Income=93189, Debt=False, OwnsProperty=True, Profession='Therapist, drama', Demographics='TikTok', Platform='280', TotalTimeSpent=2, NumberOfSessions=6, VideoID=None, VideoCategory='11', VideoLength=5939, Engagement=4, ImportanceScore=23, TimeSpentOnVideo=45, NumberOfVideosWatched=45, ScrollRate=None, Frequency='2', ProductivityLoss=5, Satisfaction=None, WatchReason='Smartphone', DeviceType='MacOS', OS='02:25:25', WatchTime='4', SelfControl=0, AddictionLevel=None, CurrentActivity='Wi-Fi', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,991 - INFO - Rejected row (Nulls): UserID=3007, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3007, Age=42, Gender='Male', Location='Bulgaria', Income=60365, Debt=True, OwnsProperty=False, Profession='Merchant navy officer', Demographics='Facebook', Platform='218', TotalTimeSpent=18, NumberOfSessions=7, VideoID=None, VideoCategory='17', VideoLength=3963, Engagement=4, ImportanceScore=29, TimeSpentOnVideo=26, NumberOfVideosWatched=25, ScrollRate=None, Frequency='2', ProductivityLoss=8, Satisfaction=None, WatchReason='Tablet', DeviceType='iOS', OS='23:41:04', WatchTime='11', SelfControl=7, AddictionLevel=None, CurrentActivity='Wi-Fi', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,991 - INFO - Rejected row (Nulls): UserID=3008, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3008, Age=41, Gender='Male', Location='Cape Verde', Income=34087, Debt=True, OwnsProperty=False, Profession='Special educational needs teacher', Demographics='YouTube', Platform='134', TotalTimeSpent=10, NumberOfSessions=8, VideoID=None, VideoCategory='-8', VideoLength=7781, Engagement=5, ImportanceScore=13, TimeSpentOnVideo=17, NumberOfVideosWatched=13, ScrollRate=None, Frequency='5', ProductivityLoss=3, Satisfaction=None, WatchReason='Tablet', DeviceType='Android', OS='01:30:18', WatchTime='7', SelfControl=4, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,992 - INFO - Rejected row (Nulls): UserID=3009, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3009, Age=30, Gender='Female', Location='Vanuatu', Income=57672, Debt=False, OwnsProperty=False, Profession='Engineer, civil (contracting)', Demographics='Facebook', Platform='151', TotalTimeSpent=15, NumberOfSessions=9, VideoID=None, VideoCategory='18', VideoLength=477, Engagement=4, ImportanceScore=12, TimeSpentOnVideo=30, NumberOfVideosWatched=35, ScrollRate=None, Frequency='6', ProductivityLoss=3, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='16:52:25', WatchTime='7', SelfControl=4, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:33,992 - INFO - Rejected row (Nulls): UserID=3010, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3010, Age=57, Gender='Female', Location='Albania', Income=75294, Debt=True, OwnsProperty=False, Profession='Engineer, drilling', Demographics='Facebook', Platform='52', TotalTimeSpent=4, NumberOfSessions=10, VideoID=None, VideoCategory='24', VideoLength=8738, Engagement=5, ImportanceScore=17, TimeSpentOnVideo=33, NumberOfVideosWatched=24, ScrollRate=None, Frequency='8', ProductivityLoss=5, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='16:57:20', WatchTime='4', SelfControl=3, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529))
2025-05-06 23:51:35,451 - INFO - Row count after dropping nulls in critical columns: 3000
2025-05-06 23:52:07,851 - INFO - Rejected row (Validation): UserID=2002, VideoID=2, Reason=Invalid SelfControl, Row=Row(UserID=2002, Age=41, Gender='Male', Location='Korea', Income=62133, Debt=True, OwnsProperty=True, Profession='Chief Marketing Officer', Demographics='Age: 41, Gender: Male, Income: 62133', Platform='YouTube', TotalTimeSpent=227, NumberOfSessions=17, VideoID=2, VideoCategory='Life Hacks', VideoLength=22, Engagement=4358, ImportanceScore=3, TimeSpentOnVideo=16, NumberOfVideosWatched=23, ScrollRate=71, Frequency='Evening', ProductivityLoss=5, Satisfaction=1, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='17:37:38', SelfControl=12, AddictionLevel=0, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Invalid SelfControl')
2025-05-06 23:52:07,852 - INFO - Rejected row (Validation): UserID=2003, VideoID=3, Reason=Negative ProductivityLoss, Row=Row(UserID=2003, Age=52, Gender='Female', Location='Zimbabwe', Income=49635, Debt=False, OwnsProperty=False, Profession='Outdoor activities/education manager', Demographics='Age: 52, Gender: Female, Income: 49635', Platform='TikTok', TotalTimeSpent=181, NumberOfSessions=10, VideoID=3, VideoCategory='ASMR', VideoLength=26, Engagement=2442, ImportanceScore=7, TimeSpentOnVideo=13, NumberOfVideosWatched=39, ScrollRate=32, Frequency='Evening', ProductivityLoss=-1, Satisfaction=6, WatchReason='Habit', DeviceType='Computer', OS='iOS', WatchTime='08:39:29', SelfControl=5, AddictionLevel=1, CurrentActivity='At school', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative ProductivityLoss')
2025-05-06 23:52:07,853 - INFO - Rejected row (Validation): UserID=2015, VideoID=15, Reason=Negative NumberOfSessions, Row=Row(UserID=2015, Age=27, Gender='Female', Location='Morocco', Income=63026, Debt=False, OwnsProperty=True, Profession='Museum education officer', Demographics='Age: 27, Gender: Female, Income: 63026', Platform='YouTube', TotalTimeSpent=80, NumberOfSessions=-1, VideoID=15, VideoCategory='Trends', VideoLength=9, Engagement=257, ImportanceScore=0, TimeSpentOnVideo=6, NumberOfVideosWatched=25, ScrollRate=62, Frequency='Afternoon', ProductivityLoss=3, Satisfaction=4, WatchReason='Habit', DeviceType='Tablet', OS='MacOS', WatchTime='22:29:16', SelfControl=8, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative NumberOfSessions')
2025-05-06 23:52:07,854 - INFO - Rejected row (Validation): UserID=2018, VideoID=18, Reason=Invalid SelfControl, Row=Row(UserID=2018, Age=26, Gender='Male', Location='Benin', Income=45541, Debt=True, OwnsProperty=True, Profession='Horticultural consultant', Demographics='Age: 26, Gender: Male, Income: 45541', Platform='Instagram', TotalTimeSpent=46, NumberOfSessions=4, VideoID=18, VideoCategory='Trends', VideoLength=12, Engagement=6814, ImportanceScore=8, TimeSpentOnVideo=15, NumberOfVideosWatched=31, ScrollRate=99, Frequency='Evening', ProductivityLoss=3, Satisfaction=8, WatchReason='Habit', DeviceType='Tablet', OS='iOS', WatchTime='17:24:13', SelfControl=12, AddictionLevel=1, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Invalid SelfControl')
2025-05-06 23:52:07,854 - INFO - Rejected row (Validation): UserID=2021, VideoID=21, Reason=Negative VideoLength, Row=Row(UserID=2021, Age=18, Gender='Other', Location='Egypt', Income=20138, Debt=False, OwnsProperty=False, Profession='Site engineer', Demographics='Age: 18, Gender: Other, Income: 20138', Platform='YouTube', TotalTimeSpent=135, NumberOfSessions=14, VideoID=21, VideoCategory='Jokes/Memes', VideoLength=-3, Engagement=1714, ImportanceScore=8, TimeSpentOnVideo=7, NumberOfVideosWatched=16, ScrollRate=58, Frequency='Evening', ProductivityLoss=4, Satisfaction=3, WatchReason='Entertainment', DeviceType='Smartphone', OS='MacOS', WatchTime='01:21:48', SelfControl=7, AddictionLevel=5, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative VideoLength')
2025-05-06 23:52:07,855 - INFO - Rejected row (Validation): UserID=2105, VideoID=105, Reason=Negative VideoLength, Row=Row(UserID=2105, Age=56, Gender='Male', Location='North Macedonia', Income=87476, Debt=True, OwnsProperty=True, Profession='Retail buyer', Demographics='Age: 56, Gender: Male, Income: 87476', Platform='Facebook', TotalTimeSpent=75, NumberOfSessions=10, VideoID=105, VideoCategory='Trends', VideoLength=-10, Engagement=6827, ImportanceScore=5, TimeSpentOnVideo=15, NumberOfVideosWatched=44, ScrollRate=81, Frequency='Evening', ProductivityLoss=1, Satisfaction=6, WatchReason='Habit', DeviceType='Smartphone', OS='Android', WatchTime='05:59:58', SelfControl=7, AddictionLevel=2, CurrentActivity='Commuting', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative VideoLength')
2025-05-06 23:52:07,856 - INFO - Rejected row (Validation): UserID=2119, VideoID=119, Reason=Negative VideoLength, Row=Row(UserID=2119, Age=39, Gender='Female', Location='Bosnia and Herzegovina', Income=55799, Debt=False, OwnsProperty=True, Profession='Environmental health practitioner', Demographics='Age: 39, Gender: Female, Income: 55799', Platform='Instagram', TotalTimeSpent=153, NumberOfSessions=8, VideoID=119, VideoCategory='Vlogs', VideoLength=-1, Engagement=4304, ImportanceScore=3, TimeSpentOnVideo=2, NumberOfVideosWatched=31, ScrollRate=46, Frequency='Evening', ProductivityLoss=7, Satisfaction=3, WatchReason='Procrastination', DeviceType='Smartphone', OS='iOS', WatchTime='12:34:22', SelfControl=10, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative VideoLength')
2025-05-06 23:52:07,856 - INFO - Rejected row (Validation): UserID=2134, VideoID=134, Reason=Negative VideoLength, Row=Row(UserID=2134, Age=46, Gender='Male', Location='Poland', Income=45872, Debt=False, OwnsProperty=True, Profession='Armed forces operational officer', Demographics='Age: 46, Gender: Male, Income: 45872', Platform='TikTok', TotalTimeSpent=108, NumberOfSessions=14, VideoID=134, VideoCategory='Pranks', VideoLength=-1, Engagement=3293, ImportanceScore=2, TimeSpentOnVideo=20, NumberOfVideosWatched=42, ScrollRate=32, Frequency='Morning', ProductivityLoss=3, Satisfaction=1, WatchReason='Boredom', DeviceType='Tablet', OS='iOS', WatchTime='20:50:57', SelfControl=5, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative VideoLength')
2025-05-06 23:52:07,857 - INFO - Rejected row (Validation): UserID=2158, VideoID=158, Reason=Negative NumberOfSessions, Row=Row(UserID=2158, Age=40, Gender='Female', Location='Mexico', Income=38041, Debt=False, OwnsProperty=True, Profession='Operational researcher', Demographics='Age: 40, Gender: Female, Income: 38041', Platform='YouTube', TotalTimeSpent=112, NumberOfSessions=-1, VideoID=158, VideoCategory='Gaming', VideoLength=15, Engagement=7885, ImportanceScore=2, TimeSpentOnVideo=15, NumberOfVideosWatched=23, ScrollRate=28, Frequency='Afternoon', ProductivityLoss=8, Satisfaction=2, WatchReason='Boredom', DeviceType='Smartphone', OS='Android', WatchTime='21:47:20', SelfControl=8, AddictionLevel=0, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative NumberOfSessions')
2025-05-06 23:52:07,858 - INFO - Rejected row (Validation): UserID=2168, VideoID=168, Reason=Negative NumberOfSessions, Row=Row(UserID=2168, Age=57, Gender='Male', Location='Niger', Income=63157, Debt=False, OwnsProperty=True, Profession='Legal secretary', Demographics='Age: 57, Gender: Male, Income: 63157', Platform='TikTok', TotalTimeSpent=201, NumberOfSessions=-3, VideoID=168, VideoCategory='Life Hacks', VideoLength=12, Engagement=6107, ImportanceScore=6, TimeSpentOnVideo=20, NumberOfVideosWatched=22, ScrollRate=24, Frequency='Night', ProductivityLoss=5, Satisfaction=6, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='23:05:37', SelfControl=7, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 17, 14, 11529), Reason='Negative NumberOfSessions')
2025-05-06 23:52:08,905 - INFO - Row count after validation filters: 2844
2025-05-06 23:52:14,382 - INFO - Updated row: UserID=2, VideoID=2131, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,383 - INFO - Updated row: UserID=6, VideoID=2917, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,383 - INFO - Updated row: UserID=9, VideoID=6266, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,384 - INFO - Updated row: UserID=22, VideoID=7873, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,385 - INFO - Updated row: UserID=54, VideoID=9473, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,385 - INFO - Updated row: UserID=63, VideoID=8481, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,386 - INFO - Updated row: UserID=64, VideoID=1410, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,386 - INFO - Updated row: UserID=70, VideoID=2991, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,387 - INFO - Updated row: UserID=73, VideoID=4366, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:14,387 - INFO - Updated row: UserID=75, VideoID=6767, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-06 23:52:17,726 - INFO - Updated row: UserID=1, VideoID=4229, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,727 - INFO - Updated row: UserID=3, VideoID=4367, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,728 - INFO - Updated row: UserID=4, VideoID=1507, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,728 - INFO - Updated row: UserID=5, VideoID=2159, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,729 - INFO - Updated row: UserID=8, VideoID=9859, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,729 - INFO - Updated row: UserID=9, VideoID=6266, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,730 - INFO - Updated row: UserID=10, VideoID=4137, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,731 - INFO - Updated row: UserID=11, VideoID=2690, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,731 - INFO - Updated row: UserID=13, VideoID=2811, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:17,732 - INFO - Updated row: UserID=16, VideoID=5939, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-06 23:52:20,516 - INFO - Row count after deduplication: 2844
2025-05-06 23:52:24,812 - INFO - Updated row: UserID=1021, VideoID=21, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,815 - INFO - Updated row: UserID=1056, VideoID=56, Field=Location, OldValue=Cocos (Keeling) Islands, NewValue=Cocos (keeling) Islands, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,816 - INFO - Updated row: UserID=1069, VideoID=69, Field=Location, OldValue=Antigua and Barbuda, NewValue=Antigua And Barbuda, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,817 - INFO - Updated row: UserID=1093, VideoID=93, Field=Location, OldValue=Falkland Islands (Malvinas), NewValue=Falkland Islands (malvinas), Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,817 - INFO - Updated row: UserID=1103, VideoID=103, Field=Location, OldValue=Trinidad and Tobago, NewValue=Trinidad And Tobago, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,819 - INFO - Updated row: UserID=1114, VideoID=114, Field=Location, OldValue=Isle of Man, NewValue=Isle Of Man, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,819 - INFO - Updated row: UserID=1119, VideoID=119, Field=Location, OldValue=Antarctica (the territory South of 60 deg S), NewValue=Antarctica (the Territory South Of 60 Deg S), Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,820 - INFO - Updated row: UserID=1125, VideoID=125, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,821 - INFO - Updated row: UserID=1133, VideoID=133, Field=Location, OldValue=Sao Tome and Principe, NewValue=Sao Tome And Principe, Reason='Trimmed and formatted Location'
2025-05-06 23:52:24,821 - INFO - Updated row: UserID=1145, VideoID=145, Field=Location, OldValue=Wallis and Futuna, NewValue=Wallis And Futuna, Reason='Trimmed and formatted Location'
2025-05-06 23:52:26,996 - INFO - Updated row: UserID=4, VideoID=1507, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:26,997 - INFO - Updated row: UserID=6, VideoID=2917, Field=Profession, OldValue=driver, NewValue=Driver, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:26,998 - INFO - Updated row: UserID=9, VideoID=6266, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:26,998 - INFO - Updated row: UserID=12, VideoID=7191, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:26,999 - INFO - Updated row: UserID=13, VideoID=2811, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:27,000 - INFO - Updated row: UserID=14, VideoID=6153, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:27,001 - INFO - Updated row: UserID=17, VideoID=8000, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:27,001 - INFO - Updated row: UserID=19, VideoID=5329, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:27,002 - INFO - Updated row: UserID=20, VideoID=3622, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:27,003 - INFO - Updated row: UserID=21, VideoID=3684, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-06 23:52:30,794 - INFO - Updated row: UserID=4, VideoID=1507, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,795 - INFO - Updated row: UserID=5, VideoID=2159, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,796 - INFO - Updated row: UserID=7, VideoID=3230, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,797 - INFO - Updated row: UserID=10, VideoID=4137, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,797 - INFO - Updated row: UserID=12, VideoID=7191, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,798 - INFO - Updated row: UserID=15, VideoID=13, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,798 - INFO - Updated row: UserID=16, VideoID=5939, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,799 - INFO - Updated row: UserID=21, VideoID=3684, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,800 - INFO - Updated row: UserID=25, VideoID=5800, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:30,801 - INFO - Updated row: UserID=26, VideoID=8813, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:52:32,796 - INFO - Updated row: UserID=6, VideoID=2917, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,797 - INFO - Updated row: UserID=10, VideoID=4137, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,798 - INFO - Updated row: UserID=17, VideoID=8000, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,798 - INFO - Updated row: UserID=18, VideoID=7220, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,799 - INFO - Updated row: UserID=25, VideoID=5800, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,800 - INFO - Updated row: UserID=26, VideoID=8813, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,800 - INFO - Updated row: UserID=32, VideoID=3689, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,801 - INFO - Updated row: UserID=36, VideoID=9581, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,801 - INFO - Updated row: UserID=38, VideoID=7820, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:32,802 - INFO - Updated row: UserID=39, VideoID=8594, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-06 23:52:38,356 - INFO - Updated row: UserID=5, VideoID=2159, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,357 - INFO - Updated row: UserID=10, VideoID=4137, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,357 - INFO - Updated row: UserID=15, VideoID=13, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,358 - INFO - Updated row: UserID=16, VideoID=5939, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,358 - INFO - Updated row: UserID=17, VideoID=8000, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,359 - INFO - Updated row: UserID=19, VideoID=5329, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,359 - INFO - Updated row: UserID=20, VideoID=3622, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,360 - INFO - Updated row: UserID=21, VideoID=3684, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,360 - INFO - Updated row: UserID=24, VideoID=653, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:38,361 - INFO - Updated row: UserID=28, VideoID=1646, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-06 23:52:42,005 - INFO - Updated row: UserID=2, VideoID=2131, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,006 - INFO - Updated row: UserID=3, VideoID=4367, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,007 - INFO - Updated row: UserID=5, VideoID=2159, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,008 - INFO - Updated row: UserID=6, VideoID=2917, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,008 - INFO - Updated row: UserID=7, VideoID=3230, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,009 - INFO - Updated row: UserID=8, VideoID=9859, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,010 - INFO - Updated row: UserID=9, VideoID=6266, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,011 - INFO - Updated row: UserID=10, VideoID=4137, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,011 - INFO - Updated row: UserID=11, VideoID=2690, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:42,012 - INFO - Updated row: UserID=12, VideoID=7191, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-06 23:52:45,498 - INFO - Null counts for video_interactions_cleaned: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 0, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 0, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 0, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 0, 'CurrentActivity': 0, 'ConnectionType': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-06 23:52:54,202 - INFO - Successfully wrote 2844 rows to s3a://datastreaming-analytics-1/staging/video_interactions
2025-05-06 23:52:54,203 - INFO - Written schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('Location', StringType(), False), StructField('Income', LongType(), False), StructField('Debt', BooleanType(), False), StructField('OwnsProperty', BooleanType(), False), StructField('Profession', StringType(), False), StructField('Demographics', StringType(), False), StructField('Platform', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), False), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), False), StructField('VideoLength', LongType(), False), StructField('Engagement', LongType(), False), StructField('ImportanceScore', LongType(), False), StructField('TimeSpentOnVideo', LongType(), False), StructField('NumberOfVideosWatched', LongType(), False), StructField('ScrollRate', LongType(), False), StructField('Frequency', StringType(), False), StructField('ProductivityLoss', LongType(), False), StructField('Satisfaction', LongType(), False), StructField('WatchReason', StringType(), False), StructField('DeviceType', StringType(), False), StructField('OS', StringType(), False), StructField('WatchTime', StringType(), False), StructField('SelfControl', LongType(), False), StructField('AddictionLevel', LongType(), False), StructField('CurrentActivity', StringType(), False), StructField('ConnectionType', StringType(), False), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-06 23:52:54,376 - INFO - Closing down clientserver connection
2025-05-08 19:15:17,706 - INFO - Initializing Spark session
2025-05-08 19:15:23,235 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics-1/raw/video_interactions: Expected authority at index 6: s3a://
2025-05-08 19:15:23,777 - INFO - AWS SDK check for s3a://datastreaming-analytics-1/raw/video_interactions: file count: 2, files: [('raw/video_interactions/_SUCCESS', 0), ('raw/video_interactions/part-00000-d1550082-a1dd-4fb2-8806-5486d6f80caa-c000.snappy.parquet', 207851)]
2025-05-08 19:15:23,789 - INFO - Reading raw data from s3a://datastreaming-analytics-1/raw/video_interactions
2025-05-08 19:15:32,757 - INFO - Raw schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('Owns Property', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('Number of Sessions', LongType(), True), StructField('Video ID', LongType(), True), StructField('Video Category', StringType(), True), StructField('Video Length', LongType(), True), StructField('Engagement', LongType(), True), StructField('Importance Score', LongType(), True), StructField('Time Spent On Video', LongType(), True), StructField('Number of Videos Watched', LongType(), True), StructField('Scroll Rate', LongType(), True), StructField('Frequency', StringType(), True), StructField('Productivity Loss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('Watch Reason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('Watch Time', StringType(), True), StructField('Self Control', LongType(), True), StructField('Addiction Level', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-08 19:15:34,933 - INFO - Schema applied for video_interactions: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('Location', StringType(), True), StructField('Income', LongType(), True), StructField('Debt', BooleanType(), True), StructField('OwnsProperty', BooleanType(), True), StructField('Profession', StringType(), True), StructField('Demographics', StringType(), True), StructField('Platform', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), True), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), True), StructField('VideoLength', LongType(), True), StructField('Engagement', LongType(), True), StructField('ImportanceScore', LongType(), True), StructField('TimeSpentOnVideo', LongType(), True), StructField('NumberOfVideosWatched', LongType(), True), StructField('ScrollRate', LongType(), True), StructField('Frequency', StringType(), True), StructField('ProductivityLoss', LongType(), True), StructField('Satisfaction', LongType(), True), StructField('WatchReason', StringType(), True), StructField('DeviceType', StringType(), True), StructField('OS', StringType(), True), StructField('WatchTime', StringType(), True), StructField('SelfControl', LongType(), True), StructField('AddictionLevel', LongType(), True), StructField('CurrentActivity', StringType(), True), StructField('ConnectionType', StringType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-08 19:15:40,316 - INFO - Raw row count: 4000
2025-05-08 19:15:43,549 - INFO - Null counts for video_interactions_before_null_drop: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 1000, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 1000, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 1000, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 1000, 'CurrentActivity': 0, 'ConnectionType': 1000, 'IngestionTimestamp': 0}
2025-05-08 19:15:45,433 - WARNING - Found 1000 rows with nulls in critical columns for video_interactions_before_null_drop
2025-05-08 19:15:46,641 - INFO - Rejected row (Nulls): UserID=3001, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3001, Age=39, Gender='Other', Location='Yemen', Income=75534, Debt=True, OwnsProperty=False, Profession='Higher education careers adviser', Demographics='YouTube', Platform='176', TotalTimeSpent=14, NumberOfSessions=1, VideoID=None, VideoCategory='19', VideoLength=4527, Engagement=3, ImportanceScore=22, TimeSpentOnVideo=25, NumberOfVideosWatched=44, ScrollRate=None, Frequency='3', ProductivityLoss=4, Satisfaction=None, WatchReason='Computer', DeviceType='MacOS', OS='14:09:22', WatchTime='5', SelfControl=3, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,642 - INFO - Rejected row (Nulls): UserID=3002, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3002, Age=53, Gender='Male', Location='United States Minor Outlying Islands', Income=53101, Debt=False, OwnsProperty=False, Profession='Medical physicist', Demographics='Facebook', Platform='285', TotalTimeSpent=14, NumberOfSessions=2, VideoID=None, VideoCategory='9', VideoLength=5062, Engagement=12, ImportanceScore=13, TimeSpentOnVideo=46, NumberOfVideosWatched=31, ScrollRate=None, Frequency='2', ProductivityLoss=3, Satisfaction=None, WatchReason='Tablet', DeviceType='Windows', OS='08:42:04', WatchTime='8', SelfControl=2, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,643 - INFO - Rejected row (Nulls): UserID=3003, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3003, Age=52, Gender='Male', Location='Nicaragua', Income=82402, Debt=True, OwnsProperty=False, Profession='Therapist, occupational', Demographics='Facebook', Platform='168', TotalTimeSpent=9, NumberOfSessions=3, VideoID=None, VideoCategory='17', VideoLength=8805, Engagement=7, ImportanceScore=17, TimeSpentOnVideo=39, NumberOfVideosWatched=55, ScrollRate=None, Frequency='3', ProductivityLoss=7, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='11:17:09', WatchTime='7', SelfControl=3, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,644 - INFO - Rejected row (Nulls): UserID=3004, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3004, Age=18, Gender='Male', Location='Kenya', Income=23257, Debt=False, OwnsProperty=False, Profession='Quarry manager', Demographics='Facebook', Platform='124', TotalTimeSpent=16, NumberOfSessions=4, VideoID=None, VideoCategory='23', VideoLength=9121, Engagement=2, ImportanceScore=29, TimeSpentOnVideo=33, NumberOfVideosWatched=94, ScrollRate=None, Frequency='7', ProductivityLoss=2, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='20:00:00', WatchTime='5', SelfControl=2, AddictionLevel=None, CurrentActivity='Wi-Fi', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,644 - INFO - Rejected row (Nulls): UserID=3005, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3005, Age=27, Gender='Female', Location='Bosnia and Herzegovina', Income=41874, Debt=False, OwnsProperty=True, Profession='Adult nurse', Demographics='Instagram', Platform='222', TotalTimeSpent=13, NumberOfSessions=5, VideoID=None, VideoCategory='5', VideoLength=3546, Engagement=4, ImportanceScore=6, TimeSpentOnVideo=14, NumberOfVideosWatched=58, ScrollRate=None, Frequency='5', ProductivityLoss=2, Satisfaction=None, WatchReason='Tablet', DeviceType='iOS', OS='03:12:17', WatchTime='6', SelfControl=6, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,645 - INFO - Rejected row (Nulls): UserID=3006, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3006, Age=42, Gender='Male', Location='Trinidad and Tobago', Income=93189, Debt=False, OwnsProperty=True, Profession='Therapist, drama', Demographics='TikTok', Platform='280', TotalTimeSpent=2, NumberOfSessions=6, VideoID=None, VideoCategory='11', VideoLength=5939, Engagement=4, ImportanceScore=23, TimeSpentOnVideo=45, NumberOfVideosWatched=45, ScrollRate=None, Frequency='2', ProductivityLoss=5, Satisfaction=None, WatchReason='Smartphone', DeviceType='MacOS', OS='02:25:25', WatchTime='4', SelfControl=0, AddictionLevel=None, CurrentActivity='Wi-Fi', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,645 - INFO - Rejected row (Nulls): UserID=3007, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3007, Age=42, Gender='Male', Location='Bulgaria', Income=60365, Debt=True, OwnsProperty=False, Profession='Merchant navy officer', Demographics='Facebook', Platform='218', TotalTimeSpent=18, NumberOfSessions=7, VideoID=None, VideoCategory='17', VideoLength=3963, Engagement=4, ImportanceScore=29, TimeSpentOnVideo=26, NumberOfVideosWatched=25, ScrollRate=None, Frequency='2', ProductivityLoss=8, Satisfaction=None, WatchReason='Tablet', DeviceType='iOS', OS='23:41:04', WatchTime='11', SelfControl=7, AddictionLevel=None, CurrentActivity='Wi-Fi', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,646 - INFO - Rejected row (Nulls): UserID=3008, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3008, Age=41, Gender='Male', Location='Cape Verde', Income=34087, Debt=True, OwnsProperty=False, Profession='Special educational needs teacher', Demographics='YouTube', Platform='134', TotalTimeSpent=10, NumberOfSessions=8, VideoID=None, VideoCategory='-8', VideoLength=7781, Engagement=5, ImportanceScore=13, TimeSpentOnVideo=17, NumberOfVideosWatched=13, ScrollRate=None, Frequency='5', ProductivityLoss=3, Satisfaction=None, WatchReason='Tablet', DeviceType='Android', OS='01:30:18', WatchTime='7', SelfControl=4, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,647 - INFO - Rejected row (Nulls): UserID=3009, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3009, Age=30, Gender='Female', Location='Vanuatu', Income=57672, Debt=False, OwnsProperty=False, Profession='Engineer, civil (contracting)', Demographics='Facebook', Platform='151', TotalTimeSpent=15, NumberOfSessions=9, VideoID=None, VideoCategory='18', VideoLength=477, Engagement=4, ImportanceScore=12, TimeSpentOnVideo=30, NumberOfVideosWatched=35, ScrollRate=None, Frequency='6', ProductivityLoss=3, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='16:52:25', WatchTime='7', SelfControl=4, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:46,647 - INFO - Rejected row (Nulls): UserID=3010, VideoID=None, Reason='Null in critical columns: UserID, VideoID, TotalTimeSpent', Row=Row(UserID=3010, Age=57, Gender='Female', Location='Albania', Income=75294, Debt=True, OwnsProperty=False, Profession='Engineer, drilling', Demographics='Facebook', Platform='52', TotalTimeSpent=4, NumberOfSessions=10, VideoID=None, VideoCategory='24', VideoLength=8738, Engagement=5, ImportanceScore=17, TimeSpentOnVideo=33, NumberOfVideosWatched=24, ScrollRate=None, Frequency='8', ProductivityLoss=5, Satisfaction=None, WatchReason='Smartphone', DeviceType='Android', OS='16:57:20', WatchTime='4', SelfControl=3, AddictionLevel=None, CurrentActivity='Mobile Data', ConnectionType=None, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014))
2025-05-08 19:15:48,646 - INFO - Row count after dropping nulls in critical columns: 3000
2025-05-08 19:16:34,222 - INFO - Rejected row (Validation): UserID=2002, VideoID=2, Reason=Invalid SelfControl, Row=Row(UserID=2002, Age=41, Gender='Male', Location='Korea', Income=62133, Debt=True, OwnsProperty=True, Profession='Chief Marketing Officer', Demographics='Age: 41, Gender: Male, Income: 62133', Platform='YouTube', TotalTimeSpent=227, NumberOfSessions=17, VideoID=2, VideoCategory='Life Hacks', VideoLength=22, Engagement=4358, ImportanceScore=3, TimeSpentOnVideo=16, NumberOfVideosWatched=23, ScrollRate=71, Frequency='Evening', ProductivityLoss=5, Satisfaction=1, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='17:37:38', SelfControl=12, AddictionLevel=0, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Invalid SelfControl')
2025-05-08 19:16:34,223 - INFO - Rejected row (Validation): UserID=2003, VideoID=3, Reason=Negative ProductivityLoss, Row=Row(UserID=2003, Age=52, Gender='Female', Location='Zimbabwe', Income=49635, Debt=False, OwnsProperty=False, Profession='Outdoor activities/education manager', Demographics='Age: 52, Gender: Female, Income: 49635', Platform='TikTok', TotalTimeSpent=181, NumberOfSessions=10, VideoID=3, VideoCategory='ASMR', VideoLength=26, Engagement=2442, ImportanceScore=7, TimeSpentOnVideo=13, NumberOfVideosWatched=39, ScrollRate=32, Frequency='Evening', ProductivityLoss=-1, Satisfaction=6, WatchReason='Habit', DeviceType='Computer', OS='iOS', WatchTime='08:39:29', SelfControl=5, AddictionLevel=1, CurrentActivity='At school', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative ProductivityLoss')
2025-05-08 19:16:34,224 - INFO - Rejected row (Validation): UserID=2015, VideoID=15, Reason=Negative NumberOfSessions, Row=Row(UserID=2015, Age=27, Gender='Female', Location='Morocco', Income=63026, Debt=False, OwnsProperty=True, Profession='Museum education officer', Demographics='Age: 27, Gender: Female, Income: 63026', Platform='YouTube', TotalTimeSpent=80, NumberOfSessions=-1, VideoID=15, VideoCategory='Trends', VideoLength=9, Engagement=257, ImportanceScore=0, TimeSpentOnVideo=6, NumberOfVideosWatched=25, ScrollRate=62, Frequency='Afternoon', ProductivityLoss=3, Satisfaction=4, WatchReason='Habit', DeviceType='Tablet', OS='MacOS', WatchTime='22:29:16', SelfControl=8, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative NumberOfSessions')
2025-05-08 19:16:34,224 - INFO - Rejected row (Validation): UserID=2018, VideoID=18, Reason=Invalid SelfControl, Row=Row(UserID=2018, Age=26, Gender='Male', Location='Benin', Income=45541, Debt=True, OwnsProperty=True, Profession='Horticultural consultant', Demographics='Age: 26, Gender: Male, Income: 45541', Platform='Instagram', TotalTimeSpent=46, NumberOfSessions=4, VideoID=18, VideoCategory='Trends', VideoLength=12, Engagement=6814, ImportanceScore=8, TimeSpentOnVideo=15, NumberOfVideosWatched=31, ScrollRate=99, Frequency='Evening', ProductivityLoss=3, Satisfaction=8, WatchReason='Habit', DeviceType='Tablet', OS='iOS', WatchTime='17:24:13', SelfControl=12, AddictionLevel=1, CurrentActivity='At work', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Invalid SelfControl')
2025-05-08 19:16:34,225 - INFO - Rejected row (Validation): UserID=2021, VideoID=21, Reason=Negative VideoLength, Row=Row(UserID=2021, Age=18, Gender='Other', Location='Egypt', Income=20138, Debt=False, OwnsProperty=False, Profession='Site engineer', Demographics='Age: 18, Gender: Other, Income: 20138', Platform='YouTube', TotalTimeSpent=135, NumberOfSessions=14, VideoID=21, VideoCategory='Jokes/Memes', VideoLength=-3, Engagement=1714, ImportanceScore=8, TimeSpentOnVideo=7, NumberOfVideosWatched=16, ScrollRate=58, Frequency='Evening', ProductivityLoss=4, Satisfaction=3, WatchReason='Entertainment', DeviceType='Smartphone', OS='MacOS', WatchTime='01:21:48', SelfControl=7, AddictionLevel=5, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative VideoLength')
2025-05-08 19:16:34,226 - INFO - Rejected row (Validation): UserID=2105, VideoID=105, Reason=Negative VideoLength, Row=Row(UserID=2105, Age=56, Gender='Male', Location='North Macedonia', Income=87476, Debt=True, OwnsProperty=True, Profession='Retail buyer', Demographics='Age: 56, Gender: Male, Income: 87476', Platform='Facebook', TotalTimeSpent=75, NumberOfSessions=10, VideoID=105, VideoCategory='Trends', VideoLength=-10, Engagement=6827, ImportanceScore=5, TimeSpentOnVideo=15, NumberOfVideosWatched=44, ScrollRate=81, Frequency='Evening', ProductivityLoss=1, Satisfaction=6, WatchReason='Habit', DeviceType='Smartphone', OS='Android', WatchTime='05:59:58', SelfControl=7, AddictionLevel=2, CurrentActivity='Commuting', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative VideoLength')
2025-05-08 19:16:34,227 - INFO - Rejected row (Validation): UserID=2119, VideoID=119, Reason=Negative VideoLength, Row=Row(UserID=2119, Age=39, Gender='Female', Location='Bosnia and Herzegovina', Income=55799, Debt=False, OwnsProperty=True, Profession='Environmental health practitioner', Demographics='Age: 39, Gender: Female, Income: 55799', Platform='Instagram', TotalTimeSpent=153, NumberOfSessions=8, VideoID=119, VideoCategory='Vlogs', VideoLength=-1, Engagement=4304, ImportanceScore=3, TimeSpentOnVideo=2, NumberOfVideosWatched=31, ScrollRate=46, Frequency='Evening', ProductivityLoss=7, Satisfaction=3, WatchReason='Procrastination', DeviceType='Smartphone', OS='iOS', WatchTime='12:34:22', SelfControl=10, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative VideoLength')
2025-05-08 19:16:34,227 - INFO - Rejected row (Validation): UserID=2134, VideoID=134, Reason=Negative VideoLength, Row=Row(UserID=2134, Age=46, Gender='Male', Location='Poland', Income=45872, Debt=False, OwnsProperty=True, Profession='Armed forces operational officer', Demographics='Age: 46, Gender: Male, Income: 45872', Platform='TikTok', TotalTimeSpent=108, NumberOfSessions=14, VideoID=134, VideoCategory='Pranks', VideoLength=-1, Engagement=3293, ImportanceScore=2, TimeSpentOnVideo=20, NumberOfVideosWatched=42, ScrollRate=32, Frequency='Morning', ProductivityLoss=3, Satisfaction=1, WatchReason='Boredom', DeviceType='Tablet', OS='iOS', WatchTime='20:50:57', SelfControl=5, AddictionLevel=4, CurrentActivity='At home', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative VideoLength')
2025-05-08 19:16:34,228 - INFO - Rejected row (Validation): UserID=2158, VideoID=158, Reason=Negative NumberOfSessions, Row=Row(UserID=2158, Age=40, Gender='Female', Location='Mexico', Income=38041, Debt=False, OwnsProperty=True, Profession='Operational researcher', Demographics='Age: 40, Gender: Female, Income: 38041', Platform='YouTube', TotalTimeSpent=112, NumberOfSessions=-1, VideoID=158, VideoCategory='Gaming', VideoLength=15, Engagement=7885, ImportanceScore=2, TimeSpentOnVideo=15, NumberOfVideosWatched=23, ScrollRate=28, Frequency='Afternoon', ProductivityLoss=8, Satisfaction=2, WatchReason='Boredom', DeviceType='Smartphone', OS='Android', WatchTime='21:47:20', SelfControl=8, AddictionLevel=0, CurrentActivity='At school', ConnectionType='Mobile Data', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative NumberOfSessions')
2025-05-08 19:16:34,229 - INFO - Rejected row (Validation): UserID=2168, VideoID=168, Reason=Negative NumberOfSessions, Row=Row(UserID=2168, Age=57, Gender='Male', Location='Niger', Income=63157, Debt=False, OwnsProperty=True, Profession='Legal secretary', Demographics='Age: 57, Gender: Male, Income: 63157', Platform='TikTok', TotalTimeSpent=201, NumberOfSessions=-3, VideoID=168, VideoCategory='Life Hacks', VideoLength=12, Engagement=6107, ImportanceScore=6, TimeSpentOnVideo=20, NumberOfVideosWatched=22, ScrollRate=24, Frequency='Night', ProductivityLoss=5, Satisfaction=6, WatchReason='Entertainment', DeviceType='Smartphone', OS='Android', WatchTime='23:05:37', SelfControl=7, AddictionLevel=0, CurrentActivity='At work', ConnectionType='Wi-Fi', IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 30, 247014), Reason='Negative NumberOfSessions')
2025-05-08 19:16:35,358 - INFO - Row count after validation filters: 2844
2025-05-08 19:16:42,886 - INFO - Updated row: UserID=2, VideoID=2131, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,889 - INFO - Updated row: UserID=6, VideoID=2917, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,889 - INFO - Updated row: UserID=9, VideoID=6266, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,890 - INFO - Updated row: UserID=22, VideoID=7873, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,890 - INFO - Updated row: UserID=54, VideoID=9473, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,891 - INFO - Updated row: UserID=63, VideoID=8481, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,892 - INFO - Updated row: UserID=64, VideoID=1410, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,892 - INFO - Updated row: UserID=70, VideoID=2991, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,893 - INFO - Updated row: UserID=73, VideoID=4366, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:42,893 - INFO - Updated row: UserID=75, VideoID=6767, Field=DeviceType, OldValue=Computer, NewValue=Desktop, Reason='Standardized DeviceType'
2025-05-08 19:16:48,097 - INFO - Updated row: UserID=1, VideoID=4229, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,100 - INFO - Updated row: UserID=3, VideoID=4367, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,100 - INFO - Updated row: UserID=4, VideoID=1507, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,101 - INFO - Updated row: UserID=5, VideoID=2159, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,102 - INFO - Updated row: UserID=8, VideoID=9859, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,103 - INFO - Updated row: UserID=9, VideoID=6266, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,105 - INFO - Updated row: UserID=10, VideoID=4137, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,106 - INFO - Updated row: UserID=11, VideoID=2690, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,107 - INFO - Updated row: UserID=13, VideoID=2811, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:48,107 - INFO - Updated row: UserID=16, VideoID=5939, Field=ConnectionType, OldValue=Mobile Data, NewValue=Cellular, Reason='Standardized ConnectionType'
2025-05-08 19:16:51,522 - INFO - Row count after deduplication: 2844
2025-05-08 19:16:57,045 - INFO - Updated row: UserID=1021, VideoID=21, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,046 - INFO - Updated row: UserID=1056, VideoID=56, Field=Location, OldValue=Cocos (Keeling) Islands, NewValue=Cocos (keeling) Islands, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,047 - INFO - Updated row: UserID=1069, VideoID=69, Field=Location, OldValue=Antigua and Barbuda, NewValue=Antigua And Barbuda, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,048 - INFO - Updated row: UserID=1093, VideoID=93, Field=Location, OldValue=Falkland Islands (Malvinas), NewValue=Falkland Islands (malvinas), Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,049 - INFO - Updated row: UserID=1103, VideoID=103, Field=Location, OldValue=Trinidad and Tobago, NewValue=Trinidad And Tobago, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,049 - INFO - Updated row: UserID=1114, VideoID=114, Field=Location, OldValue=Isle of Man, NewValue=Isle Of Man, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,050 - INFO - Updated row: UserID=1119, VideoID=119, Field=Location, OldValue=Antarctica (the territory South of 60 deg S), NewValue=Antarctica (the Territory South Of 60 Deg S), Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,050 - INFO - Updated row: UserID=1125, VideoID=125, Field=Location, OldValue=Cote d'Ivoire, NewValue=Cote D'ivoire, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,051 - INFO - Updated row: UserID=1133, VideoID=133, Field=Location, OldValue=Sao Tome and Principe, NewValue=Sao Tome And Principe, Reason='Trimmed and formatted Location'
2025-05-08 19:16:57,051 - INFO - Updated row: UserID=1145, VideoID=145, Field=Location, OldValue=Wallis and Futuna, NewValue=Wallis And Futuna, Reason='Trimmed and formatted Location'
2025-05-08 19:17:00,149 - INFO - Updated row: UserID=4, VideoID=1507, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,149 - INFO - Updated row: UserID=6, VideoID=2917, Field=Profession, OldValue=driver, NewValue=Driver, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,150 - INFO - Updated row: UserID=9, VideoID=6266, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,151 - INFO - Updated row: UserID=12, VideoID=7191, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,152 - INFO - Updated row: UserID=13, VideoID=2811, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,153 - INFO - Updated row: UserID=14, VideoID=6153, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,153 - INFO - Updated row: UserID=17, VideoID=8000, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,154 - INFO - Updated row: UserID=19, VideoID=5329, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,154 - INFO - Updated row: UserID=20, VideoID=3622, Field=Profession, OldValue=Labor/Worker, NewValue=Labor/worker, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:00,155 - INFO - Updated row: UserID=21, VideoID=3684, Field=Profession, OldValue=Waiting staff, NewValue=Waiting Staff, Reason='Trimmed and formatted Profession'
2025-05-08 19:17:06,828 - INFO - Updated row: UserID=4, VideoID=1507, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,829 - INFO - Updated row: UserID=5, VideoID=2159, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,831 - INFO - Updated row: UserID=7, VideoID=3230, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,831 - INFO - Updated row: UserID=10, VideoID=4137, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,832 - INFO - Updated row: UserID=12, VideoID=7191, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,832 - INFO - Updated row: UserID=15, VideoID=13, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,833 - INFO - Updated row: UserID=16, VideoID=5939, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,833 - INFO - Updated row: UserID=21, VideoID=3684, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,834 - INFO - Updated row: UserID=25, VideoID=5800, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:06,834 - INFO - Updated row: UserID=26, VideoID=8813, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:17:10,042 - INFO - Updated row: UserID=6, VideoID=2917, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,043 - INFO - Updated row: UserID=10, VideoID=4137, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,044 - INFO - Updated row: UserID=17, VideoID=8000, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,044 - INFO - Updated row: UserID=18, VideoID=7220, Field=VideoCategory, OldValue=ASMR, NewValue=Asmr, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,045 - INFO - Updated row: UserID=25, VideoID=5800, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,046 - INFO - Updated row: UserID=26, VideoID=8813, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,046 - INFO - Updated row: UserID=32, VideoID=3689, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,112 - INFO - Updated row: UserID=36, VideoID=9581, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,113 - INFO - Updated row: UserID=38, VideoID=7820, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:10,115 - INFO - Updated row: UserID=39, VideoID=8594, Field=VideoCategory, OldValue=Jokes/Memes, NewValue=Jokes/memes, Reason='Trimmed and formatted VideoCategory'
2025-05-08 19:17:20,431 - INFO - Updated row: UserID=5, VideoID=2159, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,432 - INFO - Updated row: UserID=10, VideoID=4137, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,433 - INFO - Updated row: UserID=15, VideoID=13, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,433 - INFO - Updated row: UserID=16, VideoID=5939, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,434 - INFO - Updated row: UserID=17, VideoID=8000, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,435 - INFO - Updated row: UserID=19, VideoID=5329, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,436 - INFO - Updated row: UserID=20, VideoID=3622, Field=OS, OldValue=MacOS, NewValue=Macos, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,436 - INFO - Updated row: UserID=21, VideoID=3684, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,437 - INFO - Updated row: UserID=24, VideoID=653, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:20,438 - INFO - Updated row: UserID=28, VideoID=1646, Field=OS, OldValue=iOS, NewValue=Ios, Reason='Trimmed and formatted OS'
2025-05-08 19:17:23,860 - INFO - Updated row: UserID=2, VideoID=2131, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,861 - INFO - Updated row: UserID=3, VideoID=4367, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,861 - INFO - Updated row: UserID=5, VideoID=2159, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,862 - INFO - Updated row: UserID=6, VideoID=2917, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,863 - INFO - Updated row: UserID=7, VideoID=3230, Field=CurrentActivity, OldValue=At school, NewValue=At School, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,863 - INFO - Updated row: UserID=8, VideoID=9859, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,864 - INFO - Updated row: UserID=9, VideoID=6266, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,865 - INFO - Updated row: UserID=10, VideoID=4137, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,866 - INFO - Updated row: UserID=11, VideoID=2690, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:23,866 - INFO - Updated row: UserID=12, VideoID=7191, Field=CurrentActivity, OldValue=At home, NewValue=At Home, Reason='Trimmed and formatted CurrentActivity'
2025-05-08 19:17:27,863 - INFO - Null counts for video_interactions_cleaned: {'UserID': 0, 'Age': 0, 'Gender': 0, 'Location': 0, 'Income': 0, 'Debt': 0, 'OwnsProperty': 0, 'Profession': 0, 'Demographics': 0, 'Platform': 0, 'TotalTimeSpent': 0, 'NumberOfSessions': 0, 'VideoID': 0, 'VideoCategory': 0, 'VideoLength': 0, 'Engagement': 0, 'ImportanceScore': 0, 'TimeSpentOnVideo': 0, 'NumberOfVideosWatched': 0, 'ScrollRate': 0, 'Frequency': 0, 'ProductivityLoss': 0, 'Satisfaction': 0, 'WatchReason': 0, 'DeviceType': 0, 'OS': 0, 'WatchTime': 0, 'SelfControl': 0, 'AddictionLevel': 0, 'CurrentActivity': 0, 'ConnectionType': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-08 19:17:36,704 - INFO - Successfully wrote 2844 rows to s3a://datastreaming-analytics-1/staging/video_interactions
2025-05-08 19:17:36,705 - INFO - Written schema: StructType([StructField('UserID', LongType(), True), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('Location', StringType(), False), StructField('Income', LongType(), False), StructField('Debt', BooleanType(), False), StructField('OwnsProperty', BooleanType(), False), StructField('Profession', StringType(), False), StructField('Demographics', StringType(), False), StructField('Platform', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('NumberOfSessions', LongType(), False), StructField('VideoID', LongType(), True), StructField('VideoCategory', StringType(), False), StructField('VideoLength', LongType(), False), StructField('Engagement', LongType(), False), StructField('ImportanceScore', LongType(), False), StructField('TimeSpentOnVideo', LongType(), False), StructField('NumberOfVideosWatched', LongType(), False), StructField('ScrollRate', LongType(), False), StructField('Frequency', StringType(), False), StructField('ProductivityLoss', LongType(), False), StructField('Satisfaction', LongType(), False), StructField('WatchReason', StringType(), False), StructField('DeviceType', StringType(), False), StructField('OS', StringType(), False), StructField('WatchTime', StringType(), False), StructField('SelfControl', LongType(), False), StructField('AddictionLevel', LongType(), False), StructField('CurrentActivity', StringType(), False), StructField('ConnectionType', StringType(), False), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-08 19:17:37,966 - INFO - Closing down clientserver connection

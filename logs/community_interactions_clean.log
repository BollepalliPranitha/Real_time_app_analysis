2025-05-06 23:27:24,324 - INFO - Initializing Spark session
2025-05-06 23:27:27,477 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics/raw/community_interactions: Expected authority at index 6: s3a://
2025-05-06 23:27:27,902 - INFO - AWS SDK check for s3a://datastreaming-analytics/raw/community_interactions: file count: 2, files: [('raw/community_interactions/_SUCCESS', 0), ('raw/community_interactions/part-00000-8ced900c-2183-4619-bbcb-f3aaa44870e1-c000.snappy.parquet', 12729)]
2025-05-06 23:27:27,903 - INFO - Reading raw data from s3a://datastreaming-analytics/raw/community_interactions
2025-05-06 23:27:35,708 - INFO - Raw schema: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), True), StructField('UserID', LongType(), True), StructField('Platform', StringType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('CommunityEngagement', LongType(), True), StructField('MembershipStatus', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:27:37,264 - INFO - Schema applied for community_interactions: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), True), StructField('UserID', LongType(), True), StructField('Platform', StringType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('CommunityEngagement', LongType(), True), StructField('MembershipStatus', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:27:40,935 - INFO - Raw row count: 1000
2025-05-06 23:27:42,246 - INFO - Null counts for community_interactions_before_null_drop: {'CommunityID': 0, 'CommunityName': 0, 'UserID': 0, 'Platform': 0, 'Age': 0, 'Gender': 0, 'CommunityEngagement': 0, 'MembershipStatus': 0, 'TotalTimeSpent': 0, 'IngestionTimestamp': 0}
2025-05-06 23:27:43,930 - INFO - Row count after dropping nulls in critical columns: 1000
2025-05-06 23:27:51,156 - INFO - Row count after validation filters: 1000
2025-05-06 23:27:53,114 - INFO - Updated row: CommunityID=2, UserID=2221, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,115 - INFO - Updated row: CommunityID=2, UserID=1924, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,116 - INFO - Updated row: CommunityID=4, UserID=2626, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,116 - INFO - Updated row: CommunityID=1, UserID=3342, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,116 - INFO - Updated row: CommunityID=2, UserID=1670, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,117 - INFO - Updated row: CommunityID=3, UserID=1000, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,117 - INFO - Updated row: CommunityID=4, UserID=3813, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,117 - INFO - Updated row: CommunityID=1, UserID=210, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,118 - INFO - Updated row: CommunityID=3, UserID=3808, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:53,118 - INFO - Updated row: CommunityID=1, UserID=2206, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:27:55,170 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=1470, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=1470, Platform='Facebook', Age=18, Gender='Male', CommunityEngagement=77, MembershipStatus='Member', TotalTimeSpent=133, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,171 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=1990, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=1990, Platform='Instagram', Age=60, Gender='Female', CommunityEngagement=54, MembershipStatus='Member', TotalTimeSpent=100, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,172 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2370, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2370, Platform='Facebook', Age=28, Gender='Male', CommunityEngagement=19, MembershipStatus='Member', TotalTimeSpent=298, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,172 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2714, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2714, Platform='TikTok', Age=39, Gender='Female', CommunityEngagement=42, MembershipStatus='Member', TotalTimeSpent=298, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,173 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2946, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2946, Platform='TikTok', Age=28, Gender='Female', CommunityEngagement=23, MembershipStatus='Member', TotalTimeSpent=142, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,174 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=3174, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=3174, Platform='Instagram', Age=65, Gender='Male', CommunityEngagement=64, MembershipStatus='Member', TotalTimeSpent=267, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,174 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=3515, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=3515, Platform='YouTube', Age=40, Gender='Male', CommunityEngagement=70, MembershipStatus='Member', TotalTimeSpent=217, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,175 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=29, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=29, Platform='TikTok', Age=42, Gender='Female', CommunityEngagement=29, MembershipStatus='Member', TotalTimeSpent=181, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,176 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=256, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=256, Platform='YouTube', Age=42, Gender='Female', CommunityEngagement=82, MembershipStatus='Member', TotalTimeSpent=234, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,176 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=987, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=987, Platform='Instagram', Age=54, Gender='Other', CommunityEngagement=95, MembershipStatus='Member', TotalTimeSpent=235, IngestionTimestamp=datetime.datetime(2025, 5, 4, 21, 50, 52, 527964), row_num=2)
2025-05-06 23:27:55,946 - INFO - Row count after deduplication: 967
2025-05-06 23:27:58,719 - INFO - Updated row: CommunityID=1, UserID=195, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,720 - INFO - Updated row: CommunityID=1, UserID=307, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,721 - INFO - Updated row: CommunityID=1, UserID=341, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,721 - INFO - Updated row: CommunityID=1, UserID=480, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,722 - INFO - Updated row: CommunityID=1, UserID=489, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,722 - INFO - Updated row: CommunityID=1, UserID=512, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,723 - INFO - Updated row: CommunityID=1, UserID=531, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,724 - INFO - Updated row: CommunityID=1, UserID=536, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,724 - INFO - Updated row: CommunityID=1, UserID=625, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:27:58,725 - INFO - Updated row: CommunityID=1, UserID=634, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:28:02,136 - INFO - Null counts for community_interactions_cleaned: {'CommunityID': 0, 'CommunityName': 0, 'UserID': 0, 'Platform': 0, 'Age': 0, 'Gender': 0, 'CommunityEngagement': 0, 'MembershipStatus': 0, 'TotalTimeSpent': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-06 23:28:09,921 - INFO - Successfully wrote 967 rows to s3a://datastreaming-analytics/staging/community_interactions
2025-05-06 23:28:09,923 - INFO - Written schema: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), False), StructField('UserID', LongType(), True), StructField('Platform', StringType(), False), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('CommunityEngagement', LongType(), False), StructField('MembershipStatus', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-06 23:28:11,112 - INFO - Closing down clientserver connection
2025-05-06 23:48:15,696 - INFO - Initializing Spark session
2025-05-06 23:48:20,826 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics-1/raw/community_interactions: Expected authority at index 6: s3a://
2025-05-06 23:48:21,219 - INFO - AWS SDK check for s3a://datastreaming-analytics-1/raw/community_interactions: file count: 2, files: [('raw/community_interactions/_SUCCESS', 0), ('raw/community_interactions/part-00000-2533934e-fb16-4490-85ff-eda96ed4bf3e-c000.snappy.parquet', 12729)]
2025-05-06 23:48:21,220 - INFO - Reading raw data from s3a://datastreaming-analytics-1/raw/community_interactions
2025-05-06 23:48:27,652 - INFO - Raw schema: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), True), StructField('UserID', LongType(), True), StructField('Platform', StringType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('CommunityEngagement', LongType(), True), StructField('MembershipStatus', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:48:29,338 - INFO - Schema applied for community_interactions: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), True), StructField('UserID', LongType(), True), StructField('Platform', StringType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('CommunityEngagement', LongType(), True), StructField('MembershipStatus', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-06 23:48:33,052 - INFO - Raw row count: 1000
2025-05-06 23:48:34,420 - INFO - Null counts for community_interactions_before_null_drop: {'CommunityID': 0, 'CommunityName': 0, 'UserID': 0, 'Platform': 0, 'Age': 0, 'Gender': 0, 'CommunityEngagement': 0, 'MembershipStatus': 0, 'TotalTimeSpent': 0, 'IngestionTimestamp': 0}
2025-05-06 23:48:35,994 - INFO - Row count after dropping nulls in critical columns: 1000
2025-05-06 23:48:43,204 - INFO - Row count after validation filters: 1000
2025-05-06 23:48:47,529 - INFO - Updated row: CommunityID=2, UserID=2221, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,530 - INFO - Updated row: CommunityID=2, UserID=1924, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,531 - INFO - Updated row: CommunityID=4, UserID=2626, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,531 - INFO - Updated row: CommunityID=1, UserID=3342, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,532 - INFO - Updated row: CommunityID=2, UserID=1670, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,532 - INFO - Updated row: CommunityID=3, UserID=1000, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,533 - INFO - Updated row: CommunityID=4, UserID=3813, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,533 - INFO - Updated row: CommunityID=1, UserID=210, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,534 - INFO - Updated row: CommunityID=3, UserID=3808, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:47,534 - INFO - Updated row: CommunityID=1, UserID=2206, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-06 23:48:49,629 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=1470, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=1470, Platform='Facebook', Age=18, Gender='Male', CommunityEngagement=77, MembershipStatus='Member', TotalTimeSpent=133, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,630 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=1990, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=1990, Platform='Instagram', Age=60, Gender='Female', CommunityEngagement=54, MembershipStatus='Member', TotalTimeSpent=100, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,630 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2370, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2370, Platform='Facebook', Age=28, Gender='Male', CommunityEngagement=19, MembershipStatus='Member', TotalTimeSpent=298, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,631 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2714, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2714, Platform='TikTok', Age=39, Gender='Female', CommunityEngagement=42, MembershipStatus='Member', TotalTimeSpent=298, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,631 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2946, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2946, Platform='TikTok', Age=28, Gender='Female', CommunityEngagement=23, MembershipStatus='Member', TotalTimeSpent=142, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,632 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=3174, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=3174, Platform='Instagram', Age=65, Gender='Male', CommunityEngagement=64, MembershipStatus='Member', TotalTimeSpent=267, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,633 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=3515, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=3515, Platform='YouTube', Age=40, Gender='Male', CommunityEngagement=70, MembershipStatus='Member', TotalTimeSpent=217, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,634 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=29, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=29, Platform='TikTok', Age=42, Gender='Female', CommunityEngagement=29, MembershipStatus='Member', TotalTimeSpent=181, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,634 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=256, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=256, Platform='YouTube', Age=42, Gender='Female', CommunityEngagement=82, MembershipStatus='Member', TotalTimeSpent=234, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:49,635 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=987, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=987, Platform='Instagram', Age=54, Gender='Other', CommunityEngagement=95, MembershipStatus='Member', TotalTimeSpent=235, IngestionTimestamp=datetime.datetime(2025, 5, 6, 23, 16, 55, 613546), row_num=2)
2025-05-06 23:48:48,371 - INFO - Row count after deduplication: 967
2025-05-06 23:48:51,166 - INFO - Updated row: CommunityID=1, UserID=195, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,167 - INFO - Updated row: CommunityID=1, UserID=307, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,167 - INFO - Updated row: CommunityID=1, UserID=341, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,168 - INFO - Updated row: CommunityID=1, UserID=480, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,169 - INFO - Updated row: CommunityID=1, UserID=489, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,169 - INFO - Updated row: CommunityID=1, UserID=512, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,170 - INFO - Updated row: CommunityID=1, UserID=531, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,171 - INFO - Updated row: CommunityID=1, UserID=536, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,172 - INFO - Updated row: CommunityID=1, UserID=625, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:51,173 - INFO - Updated row: CommunityID=1, UserID=634, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-06 23:48:54,759 - INFO - Null counts for community_interactions_cleaned: {'CommunityID': 0, 'CommunityName': 0, 'UserID': 0, 'Platform': 0, 'Age': 0, 'Gender': 0, 'CommunityEngagement': 0, 'MembershipStatus': 0, 'TotalTimeSpent': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-06 23:49:02,678 - INFO - Successfully wrote 967 rows to s3a://datastreaming-analytics-1/staging/community_interactions
2025-05-06 23:49:02,679 - INFO - Written schema: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), False), StructField('UserID', LongType(), True), StructField('Platform', StringType(), False), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('CommunityEngagement', LongType(), False), StructField('MembershipStatus', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-06 23:49:03,741 - INFO - Closing down clientserver connection
2025-05-08 19:18:11,393 - INFO - Initializing Spark session
2025-05-08 19:18:16,997 - WARNING - Hadoop check failed for S3 path s3a://datastreaming-analytics-1/raw/community_interactions: Expected authority at index 6: s3a://
2025-05-08 19:18:17,344 - INFO - AWS SDK check for s3a://datastreaming-analytics-1/raw/community_interactions: file count: 2, files: [('raw/community_interactions/_SUCCESS', 0), ('raw/community_interactions/part-00000-01849d47-cd8d-40c2-8cba-615d1f6b645d-c000.snappy.parquet', 12729)]
2025-05-08 19:18:17,345 - INFO - Reading raw data from s3a://datastreaming-analytics-1/raw/community_interactions
2025-05-08 19:18:26,555 - INFO - Raw schema: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), True), StructField('UserID', LongType(), True), StructField('Platform', StringType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('CommunityEngagement', LongType(), True), StructField('MembershipStatus', StringType(), True), StructField('Total Time Spent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-08 19:18:28,413 - INFO - Schema applied for community_interactions: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), True), StructField('UserID', LongType(), True), StructField('Platform', StringType(), True), StructField('Age', LongType(), True), StructField('Gender', StringType(), True), StructField('CommunityEngagement', LongType(), True), StructField('MembershipStatus', StringType(), True), StructField('TotalTimeSpent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True)])
2025-05-08 19:18:32,710 - INFO - Raw row count: 1000
2025-05-08 19:18:35,017 - INFO - Null counts for community_interactions_before_null_drop: {'CommunityID': 0, 'CommunityName': 0, 'UserID': 0, 'Platform': 0, 'Age': 0, 'Gender': 0, 'CommunityEngagement': 0, 'MembershipStatus': 0, 'TotalTimeSpent': 0, 'IngestionTimestamp': 0}
2025-05-08 19:18:37,668 - INFO - Row count after dropping nulls in critical columns: 1000
2025-05-08 19:18:47,421 - INFO - Row count after validation filters: 1000
2025-05-08 19:18:53,726 - INFO - Updated row: CommunityID=2, UserID=2221, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,727 - INFO - Updated row: CommunityID=2, UserID=1924, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,728 - INFO - Updated row: CommunityID=4, UserID=2626, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,729 - INFO - Updated row: CommunityID=1, UserID=3342, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,729 - INFO - Updated row: CommunityID=2, UserID=1670, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,730 - INFO - Updated row: CommunityID=3, UserID=1000, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,731 - INFO - Updated row: CommunityID=4, UserID=3813, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,732 - INFO - Updated row: CommunityID=1, UserID=210, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,733 - INFO - Updated row: CommunityID=3, UserID=3808, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:53,734 - INFO - Updated row: CommunityID=1, UserID=2206, Field=MembershipStatus, OldValue=Moderator, NewValue=Member, Reason='Standardized MembershipStatus'
2025-05-08 19:18:57,326 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=1470, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=1470, Platform='Facebook', Age=18, Gender='Male', CommunityEngagement=77, MembershipStatus='Member', TotalTimeSpent=133, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,327 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=1990, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=1990, Platform='Instagram', Age=60, Gender='Female', CommunityEngagement=54, MembershipStatus='Member', TotalTimeSpent=100, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,328 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2370, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2370, Platform='Facebook', Age=28, Gender='Male', CommunityEngagement=19, MembershipStatus='Member', TotalTimeSpent=298, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,329 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2714, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2714, Platform='TikTok', Age=39, Gender='Female', CommunityEngagement=42, MembershipStatus='Member', TotalTimeSpent=298, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,329 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=2946, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=2946, Platform='TikTok', Age=28, Gender='Female', CommunityEngagement=23, MembershipStatus='Member', TotalTimeSpent=142, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,330 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=3174, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=3174, Platform='Instagram', Age=65, Gender='Male', CommunityEngagement=64, MembershipStatus='Member', TotalTimeSpent=267, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,331 - INFO - Rejected row (Duplicate): CommunityID=1, UserID=3515, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=1, CommunityName='Gaming Fans', UserID=3515, Platform='YouTube', Age=40, Gender='Male', CommunityEngagement=70, MembershipStatus='Member', TotalTimeSpent=217, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,331 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=29, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=29, Platform='TikTok', Age=42, Gender='Female', CommunityEngagement=29, MembershipStatus='Member', TotalTimeSpent=181, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,332 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=256, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=256, Platform='YouTube', Age=42, Gender='Female', CommunityEngagement=82, MembershipStatus='Member', TotalTimeSpent=234, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:57,333 - INFO - Rejected row (Duplicate): CommunityID=2, UserID=987, Reason='Duplicate row (not most recent)', Row=Row(CommunityID=2, CommunityName='Movie Buffs', UserID=987, Platform='Instagram', Age=54, Gender='Other', CommunityEngagement=95, MembershipStatus='Member', TotalTimeSpent=235, IngestionTimestamp=datetime.datetime(2025, 5, 8, 19, 11, 2, 109376), row_num=2)
2025-05-08 19:18:58,746 - INFO - Row count after deduplication: 967
2025-05-08 19:19:04,038 - INFO - Updated row: CommunityID=1, UserID=195, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,039 - INFO - Updated row: CommunityID=1, UserID=307, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,040 - INFO - Updated row: CommunityID=1, UserID=341, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,041 - INFO - Updated row: CommunityID=1, UserID=480, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,042 - INFO - Updated row: CommunityID=1, UserID=489, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,045 - INFO - Updated row: CommunityID=1, UserID=512, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,046 - INFO - Updated row: CommunityID=1, UserID=531, Field=Platform, OldValue=YouTube, NewValue=Youtube, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,047 - INFO - Updated row: CommunityID=1, UserID=536, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,047 - INFO - Updated row: CommunityID=1, UserID=625, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:04,048 - INFO - Updated row: CommunityID=1, UserID=634, Field=Platform, OldValue=TikTok, NewValue=Tiktok, Reason='Trimmed and formatted Platform'
2025-05-08 19:19:09,649 - INFO - Null counts for community_interactions_cleaned: {'CommunityID': 0, 'CommunityName': 0, 'UserID': 0, 'Platform': 0, 'Age': 0, 'Gender': 0, 'CommunityEngagement': 0, 'MembershipStatus': 0, 'TotalTimeSpent': 0, 'IngestionTimestamp': 0, 'AgeGroup': 0}
2025-05-08 19:19:17,223 - INFO - Successfully wrote 967 rows to s3a://datastreaming-analytics-1/staging/community_interactions
2025-05-08 19:19:17,224 - INFO - Written schema: StructType([StructField('CommunityID', LongType(), True), StructField('CommunityName', StringType(), False), StructField('UserID', LongType(), True), StructField('Platform', StringType(), False), StructField('Age', LongType(), False), StructField('Gender', StringType(), False), StructField('CommunityEngagement', LongType(), False), StructField('MembershipStatus', StringType(), False), StructField('TotalTimeSpent', LongType(), True), StructField('IngestionTimestamp', TimestampType(), True), StructField('AgeGroup', StringType(), False)])
2025-05-08 19:19:17,518 - INFO - Closing down clientserver connection
